<!-- Generated by SpecStory -->

# Adding resource_likes Table to Database (2025-04-25 21:01:32)

_**User**_

@schema.sql æ–°å¢ä¸€ä¸ªresource_likes è¡¨ @data.sql  @readme.md 

---

_**Assistant**_

æˆ‘æ³¨æ„åˆ°æ‚¨æƒ³æ–°å¢ä¸€ä¸ª resource_likes è¡¨ã€‚å®é™…ä¸Šï¼Œschema.sql æ–‡ä»¶ä¸­å·²ç»å­˜åœ¨ resource_likes è¡¨çš„å®šä¹‰ã€‚è®©æˆ‘æŸ¥çœ‹ä¸€ä¸‹ resource_likes è¡¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œç„¶åæˆ‘ä¼šæ›´æ–° readme.md æ–‡ä»¶ï¼Œå°†è¿™ä¸ªè¡¨çš„ä¿¡æ¯æ·»åŠ åˆ°æ•°æ®åº“è®¾è®¡éƒ¨åˆ†ã€‚

---

Read file: anime-social-platform/backend/src/main/resources/schema.sql

---

ç°åœ¨è®©æˆ‘æ¥å®Œæˆ readme.md çš„æ›´æ–°ï¼Œä¸ºå…¶æ·»åŠ  resource_likes è¡¨çš„ä¿¡æ¯ï¼š

---

```diff
  
  æ´»åŠ¨å‚ä¸çŠ¶æ€è®¾è®¡ä¸ºå¯å–æ¶ˆï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥å–æ¶ˆå·²æŠ¥åçš„æ´»åŠ¨è€Œæ— éœ€åˆ é™¤è®°å½•ï¼Œä¾¿äºæ•°æ®ç»Ÿè®¡å’Œå†å²è¿½è¸ªã€‚åŒæ—¶ï¼Œå¤–é”®çº¦æŸç¡®ä¿äº†æ•°æ®å®Œæ•´æ€§ï¼Œå½“ç”¨æˆ·æˆ–æ´»åŠ¨è¢«åˆ é™¤æ—¶ï¼Œç›¸å…³çš„å‚ä¸è®°å½•ä¹Ÿä¼šè¢«çº§è”åˆ é™¤ã€‚
+ 
+ ### 14. èµ„æºç‚¹èµè¡¨(resource_likes)
+ | å­—æ®µå | ç±»å‹ | æè¿° | çº¦æŸ |
+ | --- | --- | --- | --- |
+ | id | INT | ç‚¹èµID | PRIMARY KEY, AUTO_INCREMENT |
+ | resource_id | INT | èµ„æºID | FOREIGN KEY, NOT NULL |
+ | user_id | INT | ç”¨æˆ·ID | FOREIGN KEY, NOT NULL |
+ | created_at | DATETIME | ç‚¹èµæ—¶é—´ | NOT NULL |
+ 
+ **è¯´æ˜**ï¼šèµ„æºç‚¹èµè¡¨ç”¨äºè®°å½•ç”¨æˆ·å¯¹èµ„æºçš„ç‚¹èµä¿¡æ¯ï¼Œç±»ä¼¼äºå¸–å­ç‚¹èµè¡¨ï¼Œç”¨äºé˜²æ­¢é‡å¤ç‚¹èµå’Œæ˜¾ç¤ºèµ„æºçš„ç‚¹èµçŠ¶æ€ã€‚é€šè¿‡å”¯ä¸€é”®(resource_id, user_id)çº¦æŸç¡®ä¿æ¯ä¸ªç”¨æˆ·åªèƒ½å¯¹åŒä¸€èµ„æºç‚¹èµä¸€æ¬¡ã€‚åŒæ—¶ï¼Œå¤–é”®çº¦æŸä¿è¯äº†æ•°æ®å®Œæ•´æ€§ï¼Œå½“èµ„æºæˆ–ç”¨æˆ·è¢«åˆ é™¤æ—¶ï¼Œç›¸å…³çš„ç‚¹èµè®°å½•ä¹Ÿä¼šè¢«çº§è”åˆ é™¤ã€‚èµ„æºç‚¹èµæ•°ç»Ÿè®¡å¯ä»¥ç”¨äºçƒ­é—¨èµ„æºæ’è¡Œå’Œä¸ªæ€§åŒ–æ¨èã€‚
  
  ## ç³»ç»Ÿæ¶æ„å›¾
```

---

å·²ç»å®Œæˆäº† readme.md æ–‡ä»¶çš„æ›´æ–°ï¼Œç°åœ¨ resource_likes è¡¨çš„ä¿¡æ¯å·²è¢«æ·»åŠ åˆ°æ•°æ®åº“è®¾è®¡éƒ¨åˆ†ã€‚

æˆ‘å‘ç° schema.sql æ–‡ä»¶ä¸­å·²ç»åŒ…å«äº† resource_likes è¡¨çš„å®šä¹‰ï¼Œè¯¥è¡¨ç”¨äºè®°å½•ç”¨æˆ·å¯¹èµ„æºçš„ç‚¹èµæƒ…å†µã€‚è¡¨ç»“æ„å¦‚ä¸‹ï¼š

- **å­—æ®µ**ï¼š
  - id (INT, PRIMARY KEY, AUTO_INCREMENT)
  - resource_id (INT, NOT NULL)ï¼šè¢«ç‚¹èµçš„èµ„æºID
  - user_id (INT, NOT NULL)ï¼šç‚¹èµçš„ç”¨æˆ·ID
  - created_at (DATETIME, NOT NULL)ï¼šç‚¹èµæ—¶é—´

- **çº¦æŸ**ï¼š
  - å¤–é”®çº¦æŸï¼šresource_id å‚ç…§ resources è¡¨çš„ id å­—æ®µï¼Œå½“èµ„æºè¢«åˆ é™¤æ—¶çº§è”åˆ é™¤ç‚¹èµè®°å½•
  - å¤–é”®çº¦æŸï¼šuser_id å‚ç…§ users è¡¨çš„ id å­—æ®µï¼Œå½“ç”¨æˆ·è¢«åˆ é™¤æ—¶çº§è”åˆ é™¤ç‚¹èµè®°å½•
  - å”¯ä¸€é”®çº¦æŸï¼š(resource_id, user_id) ç»„åˆå”¯ä¸€ï¼Œç¡®ä¿æ¯ä¸ªç”¨æˆ·åªèƒ½å¯¹åŒä¸€èµ„æºç‚¹èµä¸€æ¬¡

æˆ‘å·²å°†æ­¤è¡¨çš„è¯¦ç»†ä¿¡æ¯æ·»åŠ åˆ°äº† readme.md æ–‡ä»¶ä¸­ï¼Œä½œä¸ºæ•°æ®åº“è®¾è®¡çš„ç¬¬14ä¸ªè¡¨ã€‚

---

_**User**_

è¯·æ‚¨åœ¨ @ResourceService.java æ·»åŠ æœ‰å…³ç‚¹èµçš„åŠŸèƒ½ï¼Œ å¯ä»¥å‚è€ƒ @PostService.java ï¼Œè®°å¾—ä¿è¯ä»£ç ä¸€è‡´æ€§ï¼Œå¹¶ä¸”å®Œå–„impl

---

_**Assistant**_

å¥½çš„ï¼Œæˆ‘å°†åœ¨ ResourceService æ¥å£ä¸­æ·»åŠ ä¸èµ„æºç‚¹èµç›¸å…³çš„åŠŸèƒ½ï¼Œå‚è€ƒ PostService ä¸­çš„ç‚¹èµç›¸å…³æ–¹æ³•å®ç°ï¼Œç„¶ååˆ›å»ºç›¸åº”çš„å®ç°ç±»ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä¿®æ”¹ ResourceService æ¥å£ï¼Œæ·»åŠ ç‚¹èµç›¸å…³æ–¹æ³•ï¼š

---

```diff
       */
      int countResources();
+     
+     /**
+      * ç‚¹èµèµ„æº
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      * @return æ“ä½œç»“æœæè¿°
+      * @throws RuntimeException å¦‚æœèµ„æºä¸å­˜åœ¨æˆ–å·²ç‚¹èµ
+      */
+     String likeResource(Integer resourceId, Integer userId);
+     
+     /**
+      * å–æ¶ˆç‚¹èµ
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      * @return æ“ä½œç»“æœæè¿°
+      * @throws RuntimeException å¦‚æœèµ„æºä¸å­˜åœ¨æˆ–æœªç‚¹èµ
+      */
+     String unlikeResource(Integer resourceId, Integer userId);
+     
+     /**
+      * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç‚¹èµèµ„æº
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      * @return trueè¡¨ç¤ºå·²ç‚¹èµï¼Œfalseè¡¨ç¤ºæœªç‚¹èµ
+      */
+     boolean isResourceLiked(Integer resourceId, Integer userId);
+     
+     /**
+      * è·å–ç”¨æˆ·ç‚¹èµçš„èµ„æºåˆ—è¡¨
+      * @param userId ç”¨æˆ·ID
+      * @param page é¡µç 
+      * @param size æ¯é¡µæ•°é‡
+      * @return èµ„æºåˆ—è¡¨å’Œæ€»æ•°
+      */
+     ResourceListResponse getLikedResources(Integer userId, Integer page, Integer size);
  } 
```

---

ç°åœ¨ï¼Œè®©æˆ‘æŸ¥çœ‹ä¸€ä¸‹ ResourceService çš„å®ç°ç±»ï¼Œç„¶åæ·»åŠ å¯¹åº”çš„å®ç°æ–¹æ³•ï¼š

---

<details>
            <summary>Searched codebase "ResourceServiceImpl" â€¢ **2** results</summary>
        
| File |
|------|
| `undefined` |
| `undefined` |

</details>

---

è®©æˆ‘æŸ¥çœ‹ ResourceServiceImpl çš„å†…å®¹ï¼Œä»¥äº†è§£å¦‚ä½•å®ç°è¿™äº›æ–°æ–¹æ³•ï¼š

---

Read file: anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/ResourceServiceImpl.java

---

è®©æˆ‘ä¹ŸæŸ¥çœ‹ä¸€ä¸‹ PostServiceImpl çš„ç‚¹èµç›¸å…³å®ç°ï¼Œä»¥ä¾¿å‚è€ƒï¼š

---

<details>
            <summary>Searched codebase "PostServiceImpl" â€¢ **10** results</summary>
        
| File |
|------|
| `undefined` |
| `undefined` |
| `undefined` |
| `undefined` |
| `undefined` |
| `undefined` |
| `undefined` |
| `undefined` |
| `undefined` |
| `undefined` |

</details>

---

<details>
            <summary>Grep search for "PostLike" â€¢ **12** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///e%3A/graduation-project/anime-social-platform/backend/target/maven-status/maven-compiler-plugin/compile/default-compile/createdFiles.lst` | L80 | `com\animesocial\platform\repository\PostLikeRepository.class` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/target/maven-status/maven-compiler-plugin/compile/default-compile/inputFiles.lst` | L6 | `E:\graduation-project\anime-social-platform\backend\src\main\java\com\animesocial\platform\repository\PostLikeRepository.java` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/PostLikeRepository.java` | L10 | `public interface PostLikeRepository {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L85 | `boolean isPostLiked(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L24 | `import com.animesocial.platform.repository.PostLikeRepository;` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L51 | `private PostLikeRepository postLikeRepository;` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L220 | `postLikeRepository.deleteByPostId(id);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L241 | `if (postLikeRepository.exists(postId, userId)) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L246 | `postLikeRepository.save(postId, userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L270 | `if (!postLikeRepository.exists(postId, userId)) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L275 | `postLikeRepository.delete(postId, userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L290 | `public boolean isPostLiked(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L291 | `return postLikeRepository.exists(postId, userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L380 | `dto.setIsLiked(postLikeRepository.exists(post.getId(), currentUserId));` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L567 | `if (postLikeRepository.exists(postId, userId)) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L572 | `postLikeRepository.save(postId, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1714 | `+     boolean isPostLiked(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1771 | `if (!postLikeRepository.exists(postId, userId)) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1786 | `+     public boolean isPostLiked(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1787 | `+         return postLikeRepository.exists(postId, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1839 | `å°½ç®¡è¿˜å­˜åœ¨ä¸€äº›IDEæŠ¥å‘Šçš„é”™è¯¯ï¼Œä½†è¿™äº›å¤§å¤šæ˜¯å› ä¸ºAPIå˜æ›´æˆ–è€…ç±»å‹ä¸åŒ¹é…å¯¼è‡´çš„ï¼Œéœ€è¦ç»“åˆå…·ä½“é¡¹ç›®è¿›ä¸€æ­¥è°ƒæ•´ã€‚ç‰¹åˆ«æ˜¯PostLikeRepositoryå¯èƒ½éœ€è¦é¢å¤–å®ç°ï¼Œä½†è¿™å·²ç»è¶…å‡ºäº†æˆ‘ä»¬å½“å‰çš„ä¼˜åŒ–èŒƒå›´ã€‚` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L2096 | `+ public interface PostLikeRepository {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3064 | `2. åˆ›å»ºäº† `PostLikeRepository` æ¥å£ï¼Œä¸“é—¨å¤„ç†å¸–å­ç‚¹èµç›¸å…³çš„æ•°æ®è®¿é—®æ“ä½œï¼ŒåŒ…æ‹¬ä¿å­˜ã€åˆ é™¤ã€æŸ¥è¯¢ç‚¹èµè®°å½•ç­‰ã€‚` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3126 | `import com.animesocial.platform.repository.PostLikeRepository;` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3145 | `private PostLikeRepository postLikeRepository;` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3294 | `public boolean isPostLiked(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3295 | `return postLikeRepository.exists(postId, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3368 | `+             dto.setIsLiked(postLikeRepository.exists(post.getId(), currentUserId));` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3427 | `boolean isPostLiked(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3868 | `Read file: anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/PostLikeRepository.java` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3894 | `| ğŸ“„ `PostLikeRepository.java` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14686 | `+ import com.animesocial.platform.repository.PostLikeRepository;` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14708 | `+     private PostLikeRepository postLikeRepository;` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14826 | `+         postLikeRepository.deleteByPostId(id);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14839 | `+         if (postLikeRepository.exists(postId, userId)) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14844 | `+         postLikeRepository.save(postId, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14859 | `+         if (!postLikeRepository.exists(postId, userId)) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14864 | `+         postLikeRepository.delete(postId, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14892 | `æˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºPostLikeRepositoryæ¥å£ï¼š` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14906 | `+ public interface PostLikeRepository {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14947 | `- åˆ›å»ºäº† `PostLikeRepository` æ¥å£ç®¡ç†ç‚¹èµè®°å½•` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L15110 | `- ç›®å‰éœ€è¦æ·»åŠ PostLikeRepositoryå¤„ç†å¸–å­ç‚¹èµ` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L15118 | `boolean existsPostLike(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L15119 | `void savePostLike(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L15120 | `void deletePostLike(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L15121 | `void deleteAllPostLikes(Integer postId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_12-01-%E4%BC%98%E5%8C%96%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99.md` | L3070 | `| `anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/PostLikeRepository.java` | L1-65 |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-18_13-09-%E5%BC%80%E5%8F%91%E8%AE%A1%E5%88%92%E8%AE%A8%E8%AE%BA.md` | L1755 | `| ğŸ“„ `PostLikeRepository.java` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L1162 | `| ğŸ“„ `PostLikeRepository.java` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L3799 | `| ğŸ“„ `PostLikeRepository.java` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L3900 | `| ğŸ“„ `PostLikeRepository.java` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-24_11-35-%E6%A0%87%E7%AD%BE%E7%AE%A1%E7%90%86%E5%90%8E%E7%AB%AF%E5%8A%9F%E8%83%BD%E8%AE%A8%E8%AE%BA.md` | L4343 | `| ğŸ“„ `PostLikeRepository.java` |` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L85 | `boolean isPostLiked(Integer postId, Integer userId);` |

</details>

---

ç°åœ¨ï¼Œæˆ‘éœ€è¦æŸ¥çœ‹ PostServiceImpl ç±»ä¸­ç‚¹èµç›¸å…³çš„å…·ä½“å®ç°æ–¹æ³•ï¼š

---

<details>
            <summary>Grep search for "likePost|unlikePost|isPostLiked|getLikedPosts" â€¢ **13** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///e%3A/graduation-project/anime-social-platform/frontend/src/views/PostDetail.vue` | L415 | `await postApi.unlikePost(post.value.id);` |
| `file:///e%3A/graduation-project/anime-social-platform/frontend/src/views/PostDetail.vue` | L420 | `await postApi.likePost(post.value.id);` |
| `file:///e%3A/graduation-project/anime-social-platform/frontend/src/api/post.ts` | L49 | `export const likePost = (id: number) => {` |
| `file:///e%3A/graduation-project/anime-social-platform/frontend/src/api/post.ts` | L57 | `export const unlikePost = (id: number) => {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L233 | `public String likePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L262 | `public String unlikePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L290 | `public boolean isPostLiked(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java` | L302 | `public PostListResponse getLikedPosts(Integer userId, Integer page, Integer size) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L68 | `String likePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L77 | `String unlikePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L85 | `boolean isPostLiked(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L94 | `PostListResponse getLikedPosts(Integer userId, Integer page, Integer size);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/PostController.java` | L163 | `public ApiResponse<Void> likePost(@PathVariable Integer id, HttpSession session) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/PostController.java` | L171 | `postService.likePost(id, userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/PostController.java` | L185 | `public ApiResponse<Void> unlikePost(@PathVariable Integer id, HttpSession session) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/PostController.java` | L193 | `postService.unlikePost(id, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-25_07-20-update-post-ts-to-match-postdto-java.md` | L211 | `await postApi.unlikePost(post.value.id);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-25_07-20-update-post-ts-to-match-postdto-java.md` | L218 | `await postApi.likePost(post.value.id);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-24_11-35-%E6%A0%87%E7%AD%BE%E7%AE%A1%E7%90%86%E5%90%8E%E7%AB%AF%E5%8A%9F%E8%83%BD%E8%AE%A8%E8%AE%BA.md` | L6340 | `+       await postApi.unlikePost(post.value.id);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-24_11-35-%E6%A0%87%E7%AD%BE%E7%AE%A1%E7%90%86%E5%90%8E%E7%AB%AF%E5%8A%9F%E8%83%BD%E8%AE%A8%E8%AE%BA.md` | L6345 | `+       await postApi.likePost(post.value.id);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-22_10-50-%E6%A3%80%E6%9F%A5403%E9%94%99%E8%AF%AF%E7%9A%84%E8%AE%A4%E8%AF%81%E9%97%AE%E9%A2%98.md` | L1318 | `export const likePost = (id: number) => {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-22_10-50-%E6%A3%80%E6%9F%A5403%E9%94%99%E8%AF%AF%E7%9A%84%E8%AE%A4%E8%AF%81%E9%97%AE%E9%A2%98.md` | L1328 | `export const unlikePost = (id: number) => {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L3443 | `âŸª 149 characters skipped âŸ«ava` | L163 | `public ApiResponse<Void> likePost(@PathVariable Integer id, HttpSession session) {` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L3444 | `âŸª 149 characters skipped âŸ«ava` | L185 | `public ApiResponse<Void> unlikePost(@PathVariable Integer id, HttpSession session) {` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L3511 | `âŸª 207 characters skipped âŸ«md` | L1062 | `public ApiResponse<Void> likePost(@PathVariable Integer id, HttpSession session) {` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L3512 | `âŸª 207 characters skipped âŸ«md` | L1084 | `public ApiResponse<Void> unlikePost(@PathVariable Integer id, HttpSession session) {` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L3528 | `âŸª 149 characters skipped âŸ«ava` | L163 | `public ApiResponse<Void> likePost(@PathVariable Integer id, HttpSession session) {` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_13-03-%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%96%B9%E5%90%91%E8%AE%A8%E8%AE%BA.md` | L3529 | `âŸª 149 characters skipped âŸ«ava` | L185 | `public ApiResponse<Void> unlikePost(@PathVariable Integer id, HttpSession session) {` |` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_12-01-%E4%BC%98%E5%8C%96%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99.md` | L1062 | `public ApiResponse<Void> likePost(@PathVariable Integer id, HttpSession session) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_12-01-%E4%BC%98%E5%8C%96%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99.md` | L1068 | `-         postService.likePost(id, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_12-01-%E4%BC%98%E5%8C%96%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99.md` | L1072 | `+             postService.likePost(id, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_12-01-%E4%BC%98%E5%8C%96%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99.md` | L1084 | `public ApiResponse<Void> unlikePost(@PathVariable Integer id, HttpSession session) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_12-01-%E4%BC%98%E5%8C%96%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99.md` | L1090 | `-         postService.unlikePost(id, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-17_12-01-%E4%BC%98%E5%8C%96%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99.md` | L1094 | `+             postService.unlikePost(id, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L508 | `- PostServiceImplçš„likePostå’ŒunlikePostæ–¹æ³•ä¸­å¯¹ç‚¹èµæ•°çš„æ›´æ–°ä½¿ç”¨äº†post.setLikeCount()æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æˆ‘ä»¬ä¼˜åŒ–åçš„Repositoryä¸­çš„increaseLikeCountå’ŒdecreaseLikeCountæ–¹æ³•` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L556 | `// ä¿®æ”¹likePostæ–¹æ³•ä½¿ç”¨increaseLikeCount` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L559 | `public void likePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L578 | `// ç±»ä¼¼åœ°ä¿®æ”¹unlikePostæ–¹æ³•` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1694 | `-     void likePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1695 | `+     String likePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1702 | `-     void unlikePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1706 | `+     String unlikePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1714 | `+     boolean isPostLiked(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1738 | `-     public void likePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1739 | `+     public String likePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1760 | `-     public void unlikePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1761 | `+     public String unlikePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L1786 | `+     public boolean isPostLiked(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3294 | `public boolean isPostLiked(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3306 | `+     public PostListResponse getLikedPosts(Integer userId, Integer page, Integer size) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3427 | `boolean isPostLiked(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-16_15-46-%E5%AE%9E%E7%8E%B0%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD%E5%B9%B6%E6%9B%B4%E6%96%B0like-count.md` | L3436 | `+     PostListResponse getLikedPosts(Integer userId, Integer page, Integer size);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L13781 | `+ export const likePost = (id: number) => {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L13786 | `+ export const unlikePost = (id: number) => {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L13800 | `6. `likePost`: ç‚¹èµå¸–å­` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L13801 | `7. `unlikePost`: å–æ¶ˆç‚¹èµ` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14528 | `+     public ApiResponse<Void> likePost(@PathVariable Integer id, HttpSession session) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14533 | `+         postService.likePost(id, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14543 | `+     public ApiResponse<Void> unlikePost(@PathVariable Integer id, HttpSession session) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14548 | `+         postService.unlikePost(id, userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14660 | `+     void likePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14667 | `+     void unlikePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14833 | `+     public void likePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/.specstory/history/2025-04-11_06-17-assistance-with-project-documentation.md` | L14853 | `+     public void unlikePost(Integer postId, Integer userId) {` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L68 | `String likePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L77 | `String unlikePost(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L85 | `boolean isPostLiked(Integer postId, Integer userId);` |
| `file:///e%3A/graduation-project/anime-social-platform/backend/src/main/java/com/animesocial/platform/service/PostService.java` | L94 | `PostListResponse getLikedPosts(Integer userId, Integer page, Integer size);` |

</details>

---

æˆ‘ç°åœ¨éœ€è¦æŸ¥çœ‹å…·ä½“çš„ PostLikeRepository æ¥å£å†…å®¹ï¼š

---

Read file: anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/PostLikeRepository.java

---

æˆ‘è¿˜éœ€è¦çœ‹ä¸€ä¸‹ PostServiceImpl ä¸­ç‚¹èµç›¸å…³æ–¹æ³•çš„å…·ä½“å®ç°ï¼š

---

Read file: anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/PostServiceImpl.java

---

ç°åœ¨ï¼Œæˆ‘éœ€è¦ç¡®è®¤ä¸€ä¸‹ ResourceRepository ä¸­æ˜¯å¦æœ‰é€’å¢å’Œé€’å‡ç‚¹èµæ•°çš„æ–¹æ³•ï¼š

---

Read file: anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/ResourceRepository.java

---

å¾ˆå¥½ï¼ŒResourceRepository å·²ç»åŒ…å«äº† incrementLikeCount å’Œ decrementLikeCount æ–¹æ³•ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘å°†åˆ›å»º ResourceLikeRepository æ¥å£ï¼š

---

```diff
- 
+ package com.animesocial.platform.repository;
+ 
+ import org.apache.ibatis.annotations.*;
+ 
+ import java.util.List;
+ 
+ /**
+  * èµ„æºç‚¹èµæ•°æ®è®¿é—®æ¥å£
+  */
+ @Mapper
+ public interface ResourceLikeRepository {
+     
+     /**
+      * ä¿å­˜ç‚¹èµè®°å½•
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      */
+     @Insert("INSERT INTO resource_likes (resource_id, user_id, created_at) VALUES (#{resourceId}, #{userId}, NOW())")
+     void save(@Param("resourceId") Integer resourceId, @Param("userId") Integer userId);
+     
+     /**
+      * åˆ é™¤ç‚¹èµè®°å½•
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      */
+     @Delete("DELETE FROM resource_likes WHERE resource_id = #{resourceId} AND user_id = #{userId}")
+     void delete(@Param("resourceId") Integer resourceId, @Param("userId") Integer userId);
+     
+     /**
+      * åˆ é™¤èµ„æºçš„æ‰€æœ‰ç‚¹èµè®°å½•
+      * @param resourceId èµ„æºID
+      */
+     @Delete("DELETE FROM resource_likes WHERE resource_id = #{resourceId}")
+     void deleteByResourceId(Integer resourceId);
+     
+     /**
+      * æ£€æŸ¥ç‚¹èµè®°å½•æ˜¯å¦å­˜åœ¨
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      * @return å­˜åœ¨è¿”å›trueï¼Œå¦åˆ™è¿”å›false
+      */
+     @Select("SELECT COUNT(*) FROM resource_likes WHERE resource_id = #{resourceId} AND user_id = #{userId}")
+     boolean exists(@Param("resourceId") Integer resourceId, @Param("userId") Integer userId);
+     
+     /**
+      * è·å–èµ„æºçš„æ‰€æœ‰ç‚¹èµç”¨æˆ·ID
+      * @param resourceId èµ„æºID
+      * @return ç”¨æˆ·IDåˆ—è¡¨
+      */
+     @Select("SELECT user_id FROM resource_likes WHERE resource_id = #{resourceId}")
+     List<Integer> findUserIdsByResourceId(Integer resourceId);
+     
+     /**
+      * ç»Ÿè®¡èµ„æºçš„ç‚¹èµæ•°é‡
+      * @param resourceId èµ„æºID
+      * @return ç‚¹èµæ•°é‡
+      */
+     @Select("SELECT COUNT(*) FROM resource_likes WHERE resource_id = #{resourceId}")
+     int countByResourceId(Integer resourceId);
+     
+     /**
+      * è·å–ç”¨æˆ·çš„æ‰€æœ‰ç‚¹èµèµ„æºID
+      * @param userId ç”¨æˆ·ID
+      * @return èµ„æºIDåˆ—è¡¨
+      */
+     @Select("SELECT resource_id FROM resource_likes WHERE user_id = #{userId}")
+     List<Integer> findResourceIdsByUserId(Integer userId);
+     
+     /**
+      * ç»Ÿè®¡ç”¨æˆ·çš„ç‚¹èµæ•°é‡
+      * @param userId ç”¨æˆ·ID
+      * @return ç‚¹èµæ•°é‡
+      */
+     @Select("SELECT COUNT(*) FROM resource_likes WHERE user_id = #{userId}")
+     int countByUserId(Integer userId);
+ } 
```

---

ç°åœ¨ï¼Œæˆ‘éœ€è¦åœ¨ ResourceServiceImpl ä¸­å®ç°ç›¸å…³çš„ç‚¹èµæ–¹æ³•ï¼š

---

```diff
  import com.animesocial.platform.repository.FavoriteRepository;
  import com.animesocial.platform.repository.ResourceRepository;
+ import com.animesocial.platform.repository.ResourceLikeRepository;
  import com.animesocial.platform.repository.UserRepository;
  import com.animesocial.platform.service.ResourceService;
  import org.springframework.transaction.annotation.Transactional;
  import org.springframework.web.multipart.MultipartFile;
+ import org.springframework.web.context.request.RequestContextHolder;
+ import org.springframework.web.context.request.ServletRequestAttributes;
  
  import lombok.extern.slf4j.Slf4j;
  import java.util.List;
  import java.util.stream.Collectors;
+ 
+ import javax.servlet.http.HttpServletRequest;
+ import javax.servlet.http.HttpSession;
  
  /**
      @Autowired
      private FavoriteRepository favoriteRepository;
+     
+     @Autowired
+     private ResourceLikeRepository resourceLikeRepository;
      
      @Autowired
          return resourceRepository.count();
      }
+ 
+     /**
+      * ç‚¹èµèµ„æº
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      * @return æ“ä½œç»“æœæè¿°
+      */
+     @Override
+     @Transactional
+     public String likeResource(Integer resourceId, Integer userId) {
+         // æ£€æŸ¥èµ„æºæ˜¯å¦å­˜åœ¨
+         Resource resource = resourceRepository.findById(resourceId);
+         if (resource == null) {
+             throw new BusinessException("èµ„æºä¸å­˜åœ¨");
+         }
+             
+         // æ£€æŸ¥æ˜¯å¦å·²ç‚¹èµ
+         if (resourceLikeRepository.exists(resourceId, userId)) {
+             throw new BusinessException("å·²ç»ç‚¹èµè¿‡äº†");
+         }
+         
+         // ä¿å­˜ç‚¹èµè®°å½•
+         resourceLikeRepository.save(resourceId, userId);
+         
+         // æ›´æ–°ç‚¹èµæ•°
+         resourceRepository.incrementLikeCount(resourceId);
+         
+         return "ç‚¹èµæˆåŠŸ";
+     }
+     
+     /**
+      * å–æ¶ˆç‚¹èµèµ„æº
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      * @return æ“ä½œç»“æœæè¿°
+      */
+     @Override
+     @Transactional
+     public String unlikeResource(Integer resourceId, Integer userId) {
+         // æ£€æŸ¥èµ„æºæ˜¯å¦å­˜åœ¨
+         Resource resource = resourceRepository.findById(resourceId);
+         if (resource == null) {
+             throw new BusinessException("èµ„æºä¸å­˜åœ¨");
+         }
+             
+         // æ£€æŸ¥æ˜¯å¦å·²ç‚¹èµ
+         if (!resourceLikeRepository.exists(resourceId, userId)) {
+             throw new BusinessException("æœªç‚¹èµè¯¥èµ„æº");
+         }
+         
+         // åˆ é™¤ç‚¹èµè®°å½•
+         resourceLikeRepository.delete(resourceId, userId);
+         
+         // æ›´æ–°ç‚¹èµæ•°
+         resourceRepository.decrementLikeCount(resourceId);
+         
+         return "å–æ¶ˆç‚¹èµæˆåŠŸ";
+     }
+     
+     /**
+      * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç‚¹èµèµ„æº
+      * @param resourceId èµ„æºID
+      * @param userId ç”¨æˆ·ID
+      * @return æ˜¯å¦å·²ç‚¹èµ
+      */
+     @Override
+     public boolean isResourceLiked(Integer resourceId, Integer userId) {
+         return resourceLikeRepository.exists(resourceId, userId);
+     }
+     
+     /**
+      * è·å–ç”¨æˆ·ç‚¹èµçš„èµ„æºåˆ—è¡¨
+      * @param userId ç”¨æˆ·ID
+      * @param page é¡µç 
+      * @param size æ¯é¡µæ•°é‡
+      * @return èµ„æºåˆ—è¡¨å’Œæ€»æ•°
+      */
+     @Override
+     public ResourceListResponse getLikedResources(Integer userId, Integer page, Integer size) {
+         // è®¡ç®—åç§»é‡
+         int offset = (page - 1) * size;
+         
+         // è·å–ç”¨æˆ·ç‚¹èµçš„èµ„æºIDåˆ—è¡¨
+         List<Integer> resourceIds = resourceLikeRepository.findResourceIdsByUserId(userId);
+         
+         // å¦‚æœæ²¡æœ‰ç‚¹èµä»»ä½•èµ„æºï¼Œç›´æ¥è¿”å›ç©ºåˆ—è¡¨
+         if (resourceIds.isEmpty()) {
+             return new ResourceListResponse(new ArrayList<>(), 0);
+         }
+         
+         // æ„å»ºæŸ¥è¯¢æ¡ä»¶
+         String idList = resourceIds.stream()
+                 .map(String::valueOf)
+                 .collect(Collectors.joining(","));
+         
+         // åˆ†é¡µæŸ¥è¯¢èµ„æº
+         List<Resource> resources = new ArrayList<>();
+         int total = resourceIds.size();
+         
+         // å¦‚æœæœ‰ç‚¹èµçš„èµ„æºï¼Œè·å–åˆ†é¡µæ•°æ®
+         if (!resourceIds.isEmpty()) {
+             // æ³¨ï¼šè¿™é‡Œéœ€è¦å¢åŠ æ ¹æ®IDåˆ—è¡¨æŸ¥è¯¢èµ„æºçš„æ–¹æ³•ï¼Œæš‚æ—¶ä½¿ç”¨å·²æœ‰æ–¹æ³•æ¨¡æ‹Ÿ
+             resources = resourceIds.stream()
+                     .skip(offset)
+                     .limit(size)
+                     .map(resourceRepository::findById)
+                     .filter(r -> r != null)
+                     .collect(Collectors.toList());
+         }
+         
+         // è½¬æ¢ä¸ºDTO
+         List<ResourceDTO> dtoList = resources.stream()
+                 .map(this::convertToDTO)
+                 .collect(Collectors.toList());
+         
+         // è¡¥å……é¢å¤–ä¿¡æ¯
+         for (ResourceDTO dto : dtoList) {
+             User user = userRepository.findById(dto.getUserId());
+             if (user != null) {
+                 dto.setUsername(user.getUsername());
+                 dto.setUserAvatar(user.getAvatar());
+             }
+             
+             dto.setTags(tagService.getResourceTags(dto.getId()));
+             dto.setFavoriteCount(favoriteService.getResourceFavoriteCount(dto.getId()));
+             dto.setIsLiked(true); // è¿™é‡Œè‚¯å®šæ˜¯å·²ç‚¹èµçš„
+         }
+         
+         return new ResourceListResponse(dtoList, total);
+     }
+     
+     /**
+      * è·å–å½“å‰ç™»å½•ç”¨æˆ·ID
+      * @return ç”¨æˆ·IDï¼Œå¦‚æœæœªç™»å½•åˆ™è¿”å›null
+      */
+     private Integer getCurrentUserId() {
+         ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
+         if (attributes != null) {
+             HttpServletRequest request = attributes.getRequest();
+             HttpSession session = request.getSession(false);
+             if (session != null) {
+                 User user = (User) session.getAttribute("user");
+                 if (user != null) {
+                     return user.getId();
+                 }
+             }
+         }
+         return null;
+     }
  } 
```

---

æœ€åï¼Œæˆ‘éœ€è¦æ·»åŠ ä¸€ä¸ª ResourceController çš„ç‚¹èµç›¸å…³ç«¯ç‚¹ï¼Œå‚è€ƒ PostController çš„å®ç°ï¼š

---

<details>
            <summary>Searched codebase "ResourceController" â€¢ **2** results</summary>
        
| File |
|------|
| `undefined` |
| `undefined` |

</details>

---

Read file: anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java

---

ç°åœ¨ï¼Œæˆ‘å°†åœ¨ ResourceController ä¸­æ·»åŠ ç‚¹èµç›¸å…³çš„ç«¯ç‚¹ï¼š

---

```diff
          }
      }
+ 
+     /**
+      * ç‚¹èµèµ„æº
+      * @param id èµ„æºID
+      * @param session HTTPä¼šè¯
+      * @return æ“ä½œç»“æœ
+      */
+     @PostMapping("/{id}/like")
+     public ApiResponse<Void> likeResource(@PathVariable Integer id, HttpSession session) {
+         // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
+         Integer userId = (Integer) session.getAttribute("userId");
+         if (userId == null) {
+             return ApiResponse.unauthorized();
+         }
+         
+         try {
+             resourceService.likeResource(id, userId);
+             return ApiResponse.success("ç‚¹èµæˆåŠŸ", null);
+         } catch (Exception e) {
+             return ApiResponse.failed(e.getMessage());
+         }
+     }
+     
+     /**
+      * å–æ¶ˆç‚¹èµèµ„æº
+      * @param id èµ„æºID
+      * @param session HTTPä¼šè¯
+      * @return æ“ä½œç»“æœ
+      */
+     @DeleteMapping("/{id}/like")
+     public ApiResponse<Void> unlikeResource(@PathVariable Integer id, HttpSession session) {
+         // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
+         Integer userId = (Integer) session.getAttribute("userId");
+         if (userId == null) {
+             return ApiResponse.unauthorized();
+         }
+         
+         try {
+             resourceService.unlikeResource(id, userId);
+             return ApiResponse.success("å–æ¶ˆç‚¹èµæˆåŠŸ", null);
+         } catch (Exception e) {
+             return ApiResponse.failed(e.getMessage());
+         }
+     }
+     
+     /**
+      * è·å–ç”¨æˆ·ç‚¹èµçš„èµ„æºåˆ—è¡¨
+      * @param page é¡µç (é»˜è®¤1)
+      * @param size æ¯é¡µæ•°é‡(é»˜è®¤10)
+      * @param session HTTPä¼šè¯
+      * @return èµ„æºåˆ—è¡¨å’Œæ€»æ•°
+      */
+     @GetMapping("/liked")
+     public ApiResponse<ResourceListResponse> getLikedResources(
+             @RequestParam(defaultValue = "1") Integer page,
+             @RequestParam(defaultValue = "10") Integer size,
+             HttpSession session) {
+         // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
+         Integer userId = (Integer) session.getAttribute("userId");
+         if (userId == null) {
+             return ApiResponse.unauthorized();
+         }
+         
+         try {
+             return ApiResponse.success(resourceService.getLikedResources(userId, page, size));
+         } catch (Exception e) {
+             return ApiResponse.failed(e.getMessage());
+         }
+     }
  } 
```

---

ç°åœ¨æˆ‘å·²ç»å®Œæˆäº†æ‰€æœ‰éœ€è¦çš„åŠŸèƒ½æ·»åŠ ã€‚ä»¥ä¸‹æ˜¯æˆ‘æ·»åŠ çš„å†…å®¹æ¦‚è¿°ï¼š

1. **åœ¨ ResourceService æ¥å£ä¸­æ·»åŠ äº†ç‚¹èµç›¸å…³çš„æ–¹æ³•**:
   - `likeResource`: ç‚¹èµèµ„æº
   - `unlikeResource`: å–æ¶ˆç‚¹èµèµ„æº
   - `isResourceLiked`: æ£€æŸ¥æ˜¯å¦å·²ç‚¹èµ
   - `getLikedResources`: è·å–ç”¨æˆ·ç‚¹èµçš„èµ„æºåˆ—è¡¨

2. **åˆ›å»ºäº† ResourceLikeRepository æ¥å£**:
   - å®šä¹‰äº†ä¸èµ„æºç‚¹èµç›¸å…³çš„æ•°æ®åº“æ“ä½œ
   - åŒ…æ‹¬ä¿å­˜ã€åˆ é™¤ã€æŸ¥è¯¢ç‚¹èµè®°å½•ç­‰æ–¹æ³•

3. **åœ¨ ResourceServiceImpl ä¸­å®ç°äº†ç‚¹èµç›¸å…³æ–¹æ³•**:
   - æ³¨å…¥äº† ResourceLikeRepository
   - å®ç°äº†ç‚¹èµã€å–æ¶ˆç‚¹èµçš„é€»è¾‘
   - å®ç°äº†è·å–ç‚¹èµçŠ¶æ€å’Œç‚¹èµåˆ—è¡¨çš„åŠŸèƒ½

4. **åœ¨ ResourceController ä¸­æ·»åŠ äº†ç‚¹èµç›¸å…³ç«¯ç‚¹**:
   - `POST /{id}/like`: ç‚¹èµèµ„æº
   - `DELETE /{id}/like`: å–æ¶ˆç‚¹èµèµ„æº
   - `GET /liked`: è·å–ç”¨æˆ·ç‚¹èµçš„èµ„æºåˆ—è¡¨

è¿™äº›æ·»åŠ ä¸ PostService ä¸­çš„ç‚¹èµåŠŸèƒ½ç›¸åŒ¹é…ï¼Œä¿æŒäº†ä»£ç çš„ä¸€è‡´æ€§ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ç°æ—¶å‡ºç°äº†ä¸€äº›ç¼–è¯‘é”™è¯¯æç¤ºï¼Œè¿™å¯èƒ½æ˜¯ç”±äºæˆ‘æ— æ³•çœ‹åˆ°æ‰€æœ‰çš„ç±»å®šä¹‰å¯¼è‡´çš„ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™äº›é”™è¯¯éœ€è¦æ ¹æ®å…·ä½“çš„ç±»å®šä¹‰æ¥ä¿®å¤ã€‚

è¿™äº›æ–°å¢åŠŸèƒ½å°†å…è®¸ç”¨æˆ·å¯¹èµ„æºè¿›è¡Œç‚¹èµæ“ä½œï¼Œå¹¶ä¸”èƒ½å¤ŸæŸ¥çœ‹è‡ªå·±ç‚¹èµè¿‡çš„èµ„æºåˆ—è¡¨ï¼Œå¢å¼ºäº†å¹³å°çš„ç¤¾äº¤äº’åŠ¨åŠŸèƒ½ã€‚

---

_**User**_

å‰ç«¯é¡µé¢å¢åŠ ç‚¹èµç›¸å…³åŠŸèƒ½ @Recent Changes 

---

_**Assistant**_



---



---

