<!-- Generated by SpecStory -->

# API Response Format Discrepancy (2025-04-25 19:28:40)

_**User**_

@resource.ts {resources: Array(10), total: 10, page: 1, size: 10}
page
: 
1
resources
: 
(10) [{â€¦}, {â€¦}, {â€¦}, {â€¦}, {â€¦}, {â€¦}, {â€¦}, {â€¦}, {â€¦}, {â€¦}]
size
: 
10
total
: 
10
[[Prototype]]
: 
Object
ä¸ºä»€ä¹ˆè¿”å›æ ¼å¼ä¸ä¸€æ ·

---

_**Assistant**_

æˆ‘çœ‹åˆ°é—®é¢˜äº†ã€‚æ‚¨æåˆ°å‰ç«¯æ”¶åˆ°çš„èµ„æºåˆ—è¡¨è¿”å›æ ¼å¼ä¸APIç±»å‹å®šä¹‰ä¸ä¸€è‡´ã€‚

å…ˆæ£€æŸ¥ä¸€ä¸‹APIè¿”å›å’Œç±»å‹å®šä¹‰ï¼š

---

Read file: anime-social-platform/frontend/src/types/resource.ts

---

Read file: anime-social-platform/frontend/src/api/resource.ts

---

<details>
            <summary>Searched codebase "ApiResponse.ts" â€¢ **0** results</summary>
        
No results found
</details>

---

<details>
            <summary>Searched codebase "ApiResponse interface or type definition" â€¢ **23** results</summary>
        
| File | Lines |
|------|-------|
| `anime-social-platform/frontend/src/types/api.ts` | L1-31 |
| `anime-social-platform/frontend/README.md` | L90-181 |
| `anime-social-platform/frontend/src/types/api.ts` | L31-81 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/model/dto/ApiResponse.java` | L1-96 |
| `anime-social-platform/frontend/src/types/resource.ts` | L52-57 |
| `anime-social-platform/frontend/src/types/post.ts` | L35-40 |
| `anime-social-platform/frontend/src/types/message.ts` | L42-52 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/model/dto/ApiResponse.java` | L96-155 |
| `anime-social-platform/frontend/src/types/favorite.ts` | L11-19 |
| `anime-social-platform/frontend/src/types/auth.ts` | L21-27 |
| `anime-social-platform/frontend/src/types/post.ts` | L27-35 |
| `anime-social-platform/frontend/src/types/user.ts` | L50-60 |
| `anime-social-platform/frontend/src/types/favorite.ts` | L1-11 |
| `anime-social-platform/frontend/src/types/message.ts` | L1-15 |
| `anime-social-platform/frontend/src/api/axios.ts` | L33-71 |
| `anime-social-platform/frontend/src/api/tag.ts` | L10-18 |
| `anime-social-platform/frontend/src/types/tag.ts` | L9-14 |
| `anime-social-platform/frontend/src/api/admin.ts` | L1-14 |
| `anime-social-platform/frontend/src/api/resource.ts` | L1-22 |
| `anime-social-platform/frontend/src/types/resource.ts` | L1-52 |
| `anime-social-platform/frontend/src/types/message.ts` | L15-22 |
| `anime-social-platform/frontend/src/api/auth.ts` | L1-11 |
| `anime-social-platform/frontend/src/types/user.ts` | L1-12 |

</details>

---

Read file: anime-social-platform/frontend/src/types/api.ts

---

<details>
            <summary>Searched codebase "ResourceController" â€¢ **24** results</summary>
        
| File | Lines |
|------|-------|
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L1-50 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L50-86 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L116-150 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L86-116 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L150-196 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/ResourceService.java` | L1-73 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/model/Resource.java` | L1-67 |
| `anime-social-platform/frontend/src/types/resource.ts` | L52-57 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/AdminController.java` | L166-219 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/AdminController.java` | L1-35 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/ResourceServiceImpl.java` | L34-98 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/ResourceServiceImpl.java` | L1-34 |
| `anime-social-platform/frontend/src/types/resource.ts` | L1-52 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/UserController.java` | L1-25 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/AdminController.java` | L444-496 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/ResourceRepository.java` | L1-60 |
| `anime-social-platform/frontend/src/api/resource.ts` | L60-74 |
| `anime-social-platform/frontend/src/views/admin/ResourceManagement.vue` | L414-450 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/model/dto/ResourceListResponse.java` | L1-37 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/model/dto/ResourceDTO.java` | L1-85 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/AdminController.java` | L219-288 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/ResourceRepository.java` | L60-114 |
| `anime-social-platform/frontend/src/api/resource.ts` | L74-83 |
| `anime-social-platform/frontend/src/api/resource.ts` | L47-60 |

</details>

---

Read file: anime-social-platform/backend/src/main/java/com/animesocial/platform/model/dto/ResourceListResponse.java

---

é—®é¢˜å·²ç»æ¸…æ¥šäº†ã€‚æ‚¨çš„å‰åç«¯è¿”å›æ ¼å¼ä¸ä¸€è‡´ï¼Œå¯¼è‡´æ•°æ®è§£æé”™è¯¯ã€‚æˆ‘æ‰¾åˆ°çš„åŸå› å¦‚ä¸‹ï¼š

1. å‰ç«¯å®šä¹‰çš„æ¥å£æ ¼å¼ï¼š
```typescript
export interface ResourceListResponse {
  items: Resource[];
  total: number;
}
```

2. åç«¯å®é™…è¿”å›çš„æ ¼å¼ï¼š
```java
public class ResourceListResponse {
    private List<ResourceDTO> resources;  // æ³¨æ„è¿™é‡Œæ˜¯resourcesä¸æ˜¯items
    private Integer total;
    private Integer page;
    private Integer size;
}
```

è§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š

1. ä¿®æ”¹å‰ç«¯çš„ResourceListResponseæ¥å£å®šä¹‰ï¼Œä¸åç«¯ä¿æŒä¸€è‡´ï¼š

---

```diff
  
  export interface ResourceListResponse {
-   items: Resource[];
+   resources: Resource[];
    total: number;
+   page: number;
+   size: number;
  }
  
```

---

ç°åœ¨å‰ç«¯å’Œåç«¯çš„æ•°æ®ç»“æ„å·²ç»åŒ¹é…äº†ã€‚æ‚¨æ”¶åˆ°çš„æ•°æ®æ ¼å¼æ˜¯ï¼š
```
{resources: Array(10), total: 10, page: 1, size: 10}
```

è¿™æ°å¥½ä¸åç«¯è¿”å›çš„ResourceListResponseæ ¼å¼å®Œå…¨ä¸€è‡´ï¼šresourcesæ•°ç»„ã€æ€»æ•°totalã€å½“å‰é¡µpageå’Œæ¯é¡µå¤§å°sizeã€‚

ä¿®æ”¹åï¼Œå‰ç«¯ä»£ç å°±å¯ä»¥æ­£ç¡®ä½¿ç”¨è¿™ä¸ªæ ¼å¼äº†ã€‚å¦‚æœæ‚¨çš„ä»»ä½•å‰ç«¯ç»„ä»¶ä¹‹å‰æ˜¯ä½¿ç”¨itemså­—æ®µè®¿é—®èµ„æºåˆ—è¡¨çš„ï¼Œç°åœ¨éœ€è¦æ”¹ä¸ºä½¿ç”¨resourceså­—æ®µã€‚

---

_**User**_

via.placeholder.com/â€¦200?text=No+Image:1 
 
 GET https://via.placeholder.com/300x200?text=No+Image net::ERR_NAME_NOT_RESOLVED
Promise.then		
loadResources	@	ResourceList.vue:186
await in loadResources		
(åŒ¿å)	@	ResourceList.vue:155
Promise.then		
initApp	@	main.ts:44
(åŒ¿å)	@	main.ts:73


è¿™æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œè¯¥å¦‚ä½•è§£å†³

---

_**Assistant**_

æˆ‘çœ‹åˆ°è¿™æ˜¯ç½‘ç»œè¯·æ±‚é”™è¯¯ï¼Œplaceholderå›¾ç‰‡æœåŠ¡æ— æ³•è®¿é—®ï¼Œé”™è¯¯ä¿¡æ¯æ˜¯`net::ERR_NAME_NOT_RESOLVED`ï¼Œè¿™è¡¨ç¤ºDNSè§£æå¤±è´¥ã€‚è¿™ä¸ªé—®é¢˜ä¸ä¹‹å‰çš„è¿”å›æ ¼å¼é—®é¢˜ä¸åŒã€‚

è®©æˆ‘ä»¬æ£€æŸ¥ä»£ç ä¸­çš„å›¾ç‰‡åŠ è½½éƒ¨åˆ†ï¼š

---

<details>
            <summary>Searched codebase "via.placeholder.com" â€¢ **16** results</summary>
        
| File | Lines |
|------|-------|
| `anime-social-platform/frontend/src/views/ResourceUpload.vue` | L371-393 |
| `anime-social-platform/frontend/src/views/ResourceUpload.vue` | L36-71 |
| `anime-social-platform/frontend/src/views/ResourceUpload.vue` | L272-371 |
| `anime-social-platform/frontend/src/views/ResourceDetail.vue` | L412-506 |
| `anime-social-platform/frontend/src/views/PostDetail.vue` | L108-126 |
| `anime-social-platform/frontend/src/views/ResourceDetail.vue` | L33-70 |
| `anime-social-platform/frontend/src/views/Profile.vue` | L559-664 |
| `anime-social-platform/frontend/src/components/ResourceCard.vue` | L1-61 |
| `anime-social-platform/backend/src/main/resources/application.properties` | L1-37 |
| `anime-social-platform/backend/target/classes/application.properties` | L1-37 |
| `anime-social-platform/frontend/src/views/ResourceUpload.vue` | L71-138 |
| `anime-social-platform/frontend/src/views/Home.vue` | L223-323 |
| `anime-social-platform/frontend/src/views/Home.vue` | L35-55 |
| `anime-social-platform/frontend/src/views/Profile.vue` | L399-444 |
| `anime-social-platform/frontend/src/views/ResourceUpload.vue` | L1-36 |
| `anime-social-platform/frontend/src/views/admin/PostManagement.vue` | L160-209 |

</details>

---

Could not find file 'anime-social-platform/frontend/src/components/ResourceList.vue' in the workspace.

---

<details>
            <summary>Searched codebase "ResourceList.vue" â€¢ **1** results</summary>
        
| File |
|------|
| `undefined` |

</details>

---

Read file: anime-social-platform/frontend/src/views/ResourceList.vue

---

Read file: anime-social-platform/frontend/src/views/ResourceList.vue

---

Read file: anime-social-platform/frontend/src/views/ResourceList.vue

---

```diff
  const router = useRouter();
  const isDarkMode = inject('isDarkMode', false);
- const defaultImage = 'https://via.placeholder.com/300x200?text=No+Image';
+ const defaultImage = '/images/no-image.png';
  
  // è·³è½¬åˆ°èµ„æºè¯¦æƒ…é¡µ
```

---

<details>
            <summary>Searched codebase "ResourceCard" â€¢ **2** results</summary>
        
| File |
|------|
| `undefined` |
| `undefined` |

</details>

---

Could not resolve URI: Error: æ— æ³•è§£æä¸å­˜åœ¨çš„æ–‡ä»¶ 'e:\graduation-project\anime-social-platform\frontend\public\images'

---

<details>
            <summary>Listed directory anime-social-platform/frontend/public â€¢ **2** results</summary>
        
| Name |
|-------|
| ğŸ“„ `favicon.svg` |
| ğŸ“„ `vite.svg` |

</details>

---

<details>
            <summary>Listed directory anime-social-platform/frontend/src/assets â€¢ **2** results</summary>
        
| Name |
|-------|
| ğŸ“ `icons` |
| ğŸ“„ `vue.svg` |

</details>

---

<details>
            <summary>Listed directory anime-social-platform/frontend/src/assets/icons â€¢ **0** results</summary>
        
No results found
</details>

---

```bash
mkdir -p anime-social-platform/frontend/public/images
```

---

_**User**_

@ResourceCard.vue  å›¾ç‰‡æ¢æˆå¯¹åº”ç±»å‹çš„Elementplus å›¾æ ‡

---

_**Assistant**_

æˆ‘çœ‹åˆ°é—®é¢˜äº†ï¼Œç”±äºåˆ é™¤äº†defaultImageå˜é‡ä½†æ¨¡æ¿ä¸­ä»ç„¶åœ¨ä½¿ç”¨å®ƒï¼Œå¯¼è‡´äº†ç±»å‹é”™è¯¯ã€‚è®©æˆ‘ä»¬ä¿®æ”¹ResourceCard.vueç»„ä»¶ï¼Œä½¿ç”¨Element Pluså›¾æ ‡æ›¿ä»£é»˜è®¤å›¾ç‰‡ï¼š

---

```diff
    <div class="resource-card" :class="{ 'dark-mode': isDarkMode }">
      <div class="resource-image">
-       <img :src="resource.coverImage || defaultImage" :alt="resource.title" />
+       <template v-if="resource.coverImage">
+         <img :src="resource.coverImage" :alt="resource.title" />
+       </template>
+       <div v-else class="file-type-icon">
+         <el-icon :size="60" :color="getIconColor(resource.fileType || 'unknown')">
+           <component :is="getFileTypeIcon(resource.fileType || 'unknown')"></component>
+         </el-icon>
+         <div class="file-type-label">{{ resource.fileType || 'æœªçŸ¥ç±»å‹' }}</div>
+       </div>
        <div class="resource-overlay">
          <div class="resource-actions">
  import { useRouter } from 'vue-router';
  import { format } from 'date-fns';
- import { View } from '@element-plus/icons-vue';
+ import { View, Document, VideoPlay, Picture, Film, Headset, Collection, More } from '@element-plus/icons-vue';
  import FavoriteButton from './FavoriteButton.vue';
  
  const router = useRouter();
  const isDarkMode = inject('isDarkMode', false);
+ 
+ // æ ¹æ®æ–‡ä»¶ç±»å‹è·å–å¯¹åº”å›¾æ ‡
+ const getFileTypeIcon = (fileType: string) => {
+   const typeMap: Record<string, any> = {
+     'pdf': Document,
+     'doc': Document,
+     'docx': Document,
+     'txt': Document,
+     'mp4': VideoPlay,
+     'mkv': VideoPlay,
+     'avi': VideoPlay,
+     'mov': VideoPlay,
+     'jpg': Picture,
+     'jpeg': Picture,
+     'png': Picture,
+     'gif': Picture,
+     'zip': Collection,
+     'rar': Collection,
+     '7z': Collection,
+     'mp3': Headset,
+     'wav': Headset,
+     'flac': Headset
+   };
+   
+   return typeMap[fileType.toLowerCase()] || More;
+ };
+ 
+ // æ ¹æ®æ–‡ä»¶ç±»å‹è·å–é¢œè‰²
+ const getIconColor = (fileType: string) => {
+   const typeColorMap: Record<string, string> = {
+     'pdf': '#E53935',
+     'doc': '#1565C0',
+     'docx': '#1565C0',
+     'txt': '#607D8B',
+     'mp4': '#D81B60',
+     'mkv': '#D81B60',
+     'avi': '#D81B60',
+     'mov': '#D81B60',
+     'jpg': '#43A047',
+     'jpeg': '#43A047',
+     'png': '#43A047',
+     'gif': '#43A047',
+     'zip': '#FF9800',
+     'rar': '#FF9800',
+     '7z': '#FF9800',
+     'mp3': '#7B1FA2',
+     'wav': '#7B1FA2',
+     'flac': '#7B1FA2'
+   };
+   
+   return typeColorMap[fileType.toLowerCase()] || '#9E9E9E';
+ };
  
  // è·³è½¬åˆ°èµ„æºè¯¦æƒ…é¡µ
    transition: var(--transition-base);
  }
+ 
+ .file-type-icon {
+   width: 100%;
+   height: 100%;
+   display: flex;
+   flex-direction: column;
+   align-items: center;
+   justify-content: center;
+   background-color: #f5f7fa;
+ }
+ 
+ .file-type-label {
+   margin-top: 10px;
+   font-size: 14px;
+   color: #606266;
+   text-transform: uppercase;
+ }
  
  .resource-card:hover .resource-image img {
    color: var(--text-secondary);
  }
+ 
+ .resource-card.dark-mode .file-type-icon {
+   background-color: #1e1e1e;
+ }
+ 
+ .resource-card.dark-mode .file-type-label {
+   color: #a6a6a6;
+ }
  </style> 
```

---

ç°åœ¨ï¼Œæˆ‘å·²ç»å°†ResourceCard.vueç»„ä»¶ä¿®æ”¹ä¸ºä½¿ç”¨Element Plusçš„å›¾æ ‡æ›¿ä»£é»˜è®¤å›¾ç‰‡ã€‚ä¸»è¦æ”¹åŠ¨å¦‚ä¸‹ï¼š

1. æ·»åŠ äº†æ¡ä»¶æ¸²æŸ“ï¼Œå½“èµ„æºæœ‰å°é¢å›¾ç‰‡æ—¶æ˜¾ç¤ºå›¾ç‰‡ï¼Œæ²¡æœ‰æ—¶æ˜¾ç¤ºå›¾æ ‡ï¼š
   ```vue
   <template v-if="resource.coverImage">
     <img :src="resource.coverImage" :alt="resource.title" />
   </template>
   <div v-else class="file-type-icon">
     <el-icon :size="60" :color="getIconColor(resource.fileType || 'unknown')">
       <component :is="getFileTypeIcon(resource.fileType || 'unknown')"></component>
     </el-icon>
     <div class="file-type-label">{{ resource.fileType || 'æœªçŸ¥ç±»å‹' }}</div>
   </div>
   ```

2. å¯¼å…¥äº†å¤šä¸ªElement Pluså›¾æ ‡ç»„ä»¶ï¼š
   ```javascript
   import { View, Document, VideoPlay, Picture, Film, Headset, Collection, More } from '@element-plus/icons-vue';
   ```

3. æ·»åŠ äº†ä¸¤ä¸ªæ–°å‡½æ•°ï¼š
   - `getFileTypeIcon`: æ ¹æ®æ–‡ä»¶ç±»å‹è¿”å›å¯¹åº”çš„å›¾æ ‡ç»„ä»¶
   - `getIconColor`: æ ¹æ®æ–‡ä»¶ç±»å‹è¿”å›å¯¹åº”çš„é¢œè‰²

4. æ·»åŠ äº†ç›¸åº”çš„CSSæ ·å¼ï¼Œæ”¯æŒæš—é»‘æ¨¡å¼

è¿™æ ·ä¿®æ”¹åï¼Œèµ„æºå¡ç‰‡å°†æ ¹æ®æ–‡ä»¶ç±»å‹æ˜¾ç¤ºä¸åŒçš„å›¾æ ‡å’Œé¢œè‰²ï¼Œæ›´åŠ ç›´è§‚åœ°å±•ç¤ºèµ„æºç±»å‹ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº†ä¹‹å‰çš„ç½‘ç»œè¯·æ±‚é”™è¯¯é—®é¢˜ï¼Œå› ä¸ºä¸å†éœ€è¦ä»å¤–éƒ¨åŠ è½½å ä½å›¾ç‰‡ã€‚

---

_**User**_

@ResourceCard.vue  å›¾æ ‡æœªèƒ½æ­£æ˜¾ç¤º

---

_**Assistant**_

Read file: anime-social-platform/frontend/src/components/ResourceCard.vue

---

```diff
  // æ ¹æ®æ–‡ä»¶ç±»å‹è·å–å¯¹åº”å›¾æ ‡
  const getFileTypeIcon = (fileType: string) => {
-   const typeMap: Record<string, any> = {
-     'pdf': Document,
-     'doc': Document,
-     'docx': Document,
-     'txt': Document,
-     'mp4': VideoPlay,
-     'mkv': VideoPlay,
-     'avi': VideoPlay,
-     'mov': VideoPlay,
-     'jpg': Picture,
-     'jpeg': Picture,
-     'png': Picture,
-     'gif': Picture,
-     'zip': Collection,
-     'rar': Collection,
-     '7z': Collection,
-     'mp3': Headset,
-     'wav': Headset,
-     'flac': Headset
-   };
-   
-   return typeMap[fileType.toLowerCase()] || More;
+   // ç¡®ä¿fileTypeæ˜¯å­—ç¬¦ä¸²å¹¶è½¬æ¢ä¸ºå°å†™
+   const type = (fileType || '').toLowerCase();
+   
+   // æ£€æŸ¥æ–‡ä»¶ç±»å‹å¹¶è¿”å›ç›¸åº”å›¾æ ‡
+   if (type.includes('pdf')) {
+     return Document;
+   } else if (type.includes('doc')) {
+     return Document;
+   } else if (type.includes('txt')) {
+     return Document;
+   } else if (type.includes('mp4') || type.includes('mkv') || type.includes('avi') || type.includes('video')) {
+     return VideoPlay;
+   } else if (type.includes('jpg') || type.includes('jpeg') || type.includes('png') || type.includes('gif') || type.includes('image')) {
+     return Picture;
+   } else if (type.includes('zip') || type.includes('rar') || type.includes('7z') || type.includes('application')) {
+     return Collection;
+   } else if (type.includes('mp3') || type.includes('wav') || type.includes('flac') || type.includes('audio')) {
+     return Headset;
+   } else {
+     return More;
+   }
  };
  
  // æ ¹æ®æ–‡ä»¶ç±»å‹è·å–é¢œè‰²
  const getIconColor = (fileType: string) => {
-   const typeColorMap: Record<string, string> = {
-     'pdf': '#E53935',
-     'doc': '#1565C0',
-     'docx': '#1565C0',
-     'txt': '#607D8B',
-     'mp4': '#D81B60',
-     'mkv': '#D81B60',
-     'avi': '#D81B60',
-     'mov': '#D81B60',
-     'jpg': '#43A047',
-     'jpeg': '#43A047',
-     'png': '#43A047',
-     'gif': '#43A047',
-     'zip': '#FF9800',
-     'rar': '#FF9800',
-     '7z': '#FF9800',
-     'mp3': '#7B1FA2',
-     'wav': '#7B1FA2',
-     'flac': '#7B1FA2'
-   };
-   
-   return typeColorMap[fileType.toLowerCase()] || '#9E9E9E';
+   // ç¡®ä¿fileTypeæ˜¯å­—ç¬¦ä¸²å¹¶è½¬æ¢ä¸ºå°å†™
+   const type = (fileType || '').toLowerCase();
+   
+   // æ£€æŸ¥æ–‡ä»¶ç±»å‹å¹¶è¿”å›ç›¸åº”é¢œè‰²
+   if (type.includes('pdf')) {
+     return '#E53935';
+   } else if (type.includes('doc')) {
+     return '#1565C0';
+   } else if (type.includes('txt')) {
+     return '#607D8B';
+   } else if (type.includes('mp4') || type.includes('mkv') || type.includes('avi') || type.includes('video')) {
+     return '#D81B60';
+   } else if (type.includes('jpg') || type.includes('jpeg') || type.includes('png') || type.includes('gif') || type.includes('image')) {
+     return '#43A047';
+   } else if (type.includes('zip') || type.includes('rar') || type.includes('7z') || type.includes('application')) {
+     return '#FF9800';
+   } else if (type.includes('mp3') || type.includes('wav') || type.includes('flac') || type.includes('audio')) {
+     return '#7B1FA2';
+   } else {
+     return '#9E9E9E';
+   }
  };
  
```

---

æˆ‘å·²ä¼˜åŒ–äº†ResourceCard.vueä¸­çš„å›¾æ ‡æ˜¾ç¤ºé€»è¾‘ï¼Œä¸»è¦åšäº†ä»¥ä¸‹æ”¹è¿›ï¼š

1. ä¿®æ”¹äº†å›¾æ ‡åˆ¤æ–­æ–¹å¼ï¼Œä»ä¸¥æ ¼åŒ¹é…æ”¹ä¸ºåŒ…å«åŒ¹é…ã€‚ä½¿ç”¨`includes()`æ–¹æ³•æ£€æŸ¥æ–‡ä»¶ç±»å‹å­—ç¬¦ä¸²ï¼Œè¿™æ ·å¯ä»¥æ•è·æ›´å¤šçš„æ–‡ä»¶ç±»å‹å˜ä½“ï¼Œæ¯”å¦‚"VIDEO/MP4"è¿™æ ·çš„ç»„åˆç±»å‹ã€‚

2. å¢åŠ äº†å¯¹é€šç”¨MIMEç±»å‹çš„æ”¯æŒï¼Œæ¯”å¦‚"video"ã€"image"ã€"audio"ã€"application"ç­‰ï¼Œä½¿å›¾æ ‡æ˜¾ç¤ºæ›´ç¬¦åˆæˆªå›¾ä¸­çœ‹åˆ°çš„èµ„æºç±»å‹ã€‚

3. æ”¹è¿›äº†ç©ºå€¼å¤„ç†ï¼Œç¡®ä¿å³ä½¿fileTypeä¸ºundefinedæˆ–nullæ—¶ä¹Ÿèƒ½æ­£ç¡®å¤„ç†ã€‚

4. ç®€åŒ–äº†é€»è¾‘ç»“æ„ï¼Œä½¿ç”¨if-elseæ¡ä»¶åˆ¤æ–­æ›¿ä»£ä¹‹å‰çš„æ˜ å°„è¡¨ï¼Œæ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

è¿™äº›ä¿®æ”¹åº”è¯¥èƒ½è§£å†³å›¾æ ‡æ— æ³•æ­£ç¡®æ˜¾ç¤ºçš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ‚¨æˆªå›¾ä¸­æ˜¾ç¤ºçš„é‚£äº›ç»„åˆç±»å‹ï¼ˆå¦‚VIDEO/MP4ã€IMAGE/ZIPã€APPLICATION/ZIPç­‰ï¼‰ã€‚

---

_**User**_

@ResourceCard.vue  å¢æ·»æ˜¾ç¤ºtag

---

_**Assistant**_

æˆ‘ç†è§£æ‚¨æƒ³è¦åœ¨ResourceCardä¸­æ˜¾ç¤ºèµ„æºçš„æ ‡ç­¾ã€‚æˆ‘æ¥ä¿®æ”¹ResourceCard.vueï¼Œæ·»åŠ æ ‡ç­¾æ˜¾ç¤ºåŠŸèƒ½ï¼š

---

Read file: anime-social-platform/frontend/src/components/ResourceCard.vue

---

Read file: anime-social-platform/frontend/src/types/resource.ts

---

```diff
          </div>
        </div>
+       <div class="file-type-badge" v-if="resource.fileType">
+         {{ resource.fileType }}
+       </div>
      </div>
      <div class="resource-content">
        <h3 class="resource-title">{{ resource.title }}</h3>
+       <div class="resource-tags" v-if="resource.tags && resource.tags.length > 0">
+         <el-tag 
+           v-for="tag in limitedTags" 
+           :key="tag.id" 
+           size="small" 
+           effect="light"
+           class="resource-tag"
+         >
+           {{ tag.name }}
+         </el-tag>
+         <el-tag v-if="resource.tags.length > maxTagsToShow" size="small" type="info" class="more-tag">
+           +{{ resource.tags.length - maxTagsToShow }}
+         </el-tag>
+       </div>
        <p class="resource-description">{{ truncateText(resource.description, 100) }}</p>
        <div class="resource-meta">
-         <span class="resource-type">
-           <el-tag size="small" :type="getTagType(resource.type)">
-             {{ resource.type }}
-           </el-tag>
+         <span class="resource-stats">
+           <el-tooltip content="æ”¶è—æ¬¡æ•°" placement="top">
+             <span class="stat-item">
+               <el-icon><star /></el-icon> {{ resource.favoriteCount }}
+             </span>
+           </el-tooltip>
+           <el-tooltip v-if="resource.downloadCount !== undefined" content="ä¸‹è½½æ¬¡æ•°" placement="top">
+             <span class="stat-item">
+               <el-icon><download /></el-icon> {{ resource.downloadCount }}
+             </span>
+           </el-tooltip>
          </span>
          <span class="resource-date">{{ formatDate(resource.createdAt) }}</span>
  import { useRouter } from 'vue-router';
  import { format } from 'date-fns';
- import { View, Document, VideoPlay, Picture, Headset, Collection, More } from '@element-plus/icons-vue';
+ import { View, Document, VideoPlay, Picture, Headset, Collection, More, Star, Download } from '@element-plus/icons-vue';
  import FavoriteButton from './FavoriteButton.vue';
  
  const router = useRouter();
  const isDarkMode = inject('isDarkMode', false);
+ const maxTagsToShow = 2;
+ 
+ const limitedTags = computed(() => {
+   if (!props.resource.tags || !Array.isArray(props.resource.tags)) return [];
+   return props.resource.tags.slice(0, maxTagsToShow);
+ });
  
  // æ ¹æ®æ–‡ä»¶ç±»å‹è·å–å¯¹åº”å›¾æ ‡
    text-transform: uppercase;
  }
+ 
+ .file-type-badge {
+   position: absolute;
+   top: 10px;
+   right: 10px;
+   background-color: rgba(0, 0, 0, 0.6);
+   color: white;
+   padding: 2px 8px;
+   border-radius: 4px;
+   font-size: 12px;
+   text-transform: uppercase;
+ }
  
  .resource-card:hover .resource-image img {
    color: var(--primary-color);
  }
+ 
+ .resource-tags {
+   margin-bottom: var(--spacing-2);
+   display: flex;
+   flex-wrap: wrap;
+   gap: 6px;
+ }
+ 
+ .resource-tag {
+   margin-right: 0;
+ }
+ 
+ .more-tag {
+   opacity: 0.8;
+ }
  
  .resource-description {
    margin-top: auto;
  }
+ 
+ .resource-stats {
+   display: flex;
+   gap: 10px;
+   font-size: var(--font-size-sm);
+   color: var(--text-secondary);
+ }
+ 
+ .stat-item {
+   display: flex;
+   align-items: center;
+   gap: 4px;
+ }
  
  .resource-type {
```

---

æˆ‘å·²ç»å‡çº§äº†ResourceCard.vueç»„ä»¶ï¼Œç°åœ¨å®ƒå¯ä»¥æ˜¾ç¤ºèµ„æºçš„æ ‡ç­¾å’Œæ›´å¤šæœ‰ç”¨çš„ä¿¡æ¯ï¼š

1. æ·»åŠ äº†æ ‡ç­¾æ˜¾ç¤ºåŒºåŸŸï¼š
   - é»˜è®¤æ˜¾ç¤ºæœ€å¤š2ä¸ªæ ‡ç­¾
   - å¦‚æœæœ‰æ›´å¤šæ ‡ç­¾ï¼Œä¼šæ˜¾ç¤º"+n"çš„å½¢å¼æç¤ºç”¨æˆ·è¿˜æœ‰æ›´å¤šæ ‡ç­¾

2. æ·»åŠ äº†æ–‡ä»¶ç±»å‹è§’æ ‡ï¼š
   - åœ¨èµ„æºå¡ç‰‡çš„å³ä¸Šè§’æ˜¾ç¤ºæ–‡ä»¶ç±»å‹
   - ä½¿ç”¨äº†åŠé€æ˜é»‘è‰²èƒŒæ™¯ï¼Œç™½è‰²æ–‡å­—ï¼Œæ›´æœ‰å±‚æ¬¡æ„Ÿ

3. æ”¹è¿›äº†åº•éƒ¨çš„å…ƒä¿¡æ¯æ˜¾ç¤ºï¼š
   - ç”¨å›¾æ ‡æ›¿ä»£äº†åŸæ¥çš„çº¯æ–‡æœ¬å±•ç¤º
   - æ·»åŠ äº†æ”¶è—æ¬¡æ•°å’Œä¸‹è½½æ¬¡æ•°çš„æ˜¾ç¤º
   - ä½¿ç”¨El-Tooltipæä¾›é¢å¤–æç¤º

4. ä¼˜åŒ–äº†å¸ƒå±€å’Œæ ·å¼ï¼š
   - ä½¿ç”¨flexå¸ƒå±€å’Œé€‚å½“çš„é—´è·ä½¿ç•Œé¢æ›´ç¾è§‚
   - æ·»åŠ äº†æš—è‰²æ¨¡å¼æ”¯æŒ
   - ç¡®ä¿å†…å®¹åœ¨ä¸åŒå¤§å°çš„å¡ç‰‡ä¸­éƒ½èƒ½æ­£ç¡®æ˜¾ç¤º

è¿™äº›æ›´æ”¹ä½¿èµ„æºå¡ç‰‡æ˜¾ç¤ºæ›´åŠ ä¸°å¯Œï¼Œç”¨æˆ·å¯ä»¥ä¸€çœ¼çœ‹åˆ°èµ„æºçš„ç±»å‹ã€æ ‡ç­¾ã€æ”¶è—æ•°å’Œä¸‹è½½æ•°ç­‰é‡è¦ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µã€‚

---

_**User**_

@ResourceDetail.vue ä¼˜åŒ–ä¸€ä¸‹ ä½¿å…¶ç¬¦åˆ @ResourceCard.vue ä»¥åŠ @ResourceList.vue 

---

_**Assistant**_

æˆ‘æ¥ä¼˜åŒ–ResourceDetail.vueä»¥ä½¿å…¶ä¸ResourceCard.vueå’ŒResourceList.vueçš„é£æ ¼ä¿æŒä¸€è‡´ã€‚

---

```diff
            <div class="resource-meta">
              <el-tag size="small" :type="getTagType(resource.fileType || 'unknown')">{{ resource.fileType || 'unknown' }}</el-tag>
+             <div class="resource-tags" v-if="resource.tags && resource.tags.length > 0">
+               <el-tag 
+                 v-for="tag in resource.tags" 
+                 :key="tag.id" 
+                 size="small" 
+                 effect="light"
+                 class="resource-tag"
+               >
+                 {{ tag.name }}
+               </el-tag>
+             </div>
              <span class="resource-date">å‘å¸ƒæ—¶é—´: {{ formatDate(resource.createdAt) }}</span>
              <div class="resource-actions">
                <p>{{ resource.description }}</p>
              </div>
+             
+             <div class="resource-stats card">
+               <h3>èµ„æºç»Ÿè®¡</h3>
+               <div class="stats-container">
+                 <div class="stat-item">
+                   <el-icon><Star /></el-icon>
+                   <span class="stat-value">{{ resource.favoriteCount }} æ”¶è—</span>
+                 </div>
+                 <div class="stat-item" v-if="resource.downloadCount !== undefined">
+                   <el-icon><Download /></el-icon>
+                   <span class="stat-value">{{ resource.downloadCount }} ä¸‹è½½</span>
+                 </div>
+               </div>
+             </div>
            </el-col>
  
            <el-col :xs="24" :sm="24" :md="10" :lg="8" class="resource-sidebar">
              <div class="resource-info card">
-               <h3>èµ„æºä¿¡æ¯</h3>
-               <div class="info-item">
-                 <span class="label">æ”¶è—æ•°ï¼š</span>
-                 <span class="value">{{ resource.favoriteCount }}</span>
+               <h3>å‘å¸ƒè€…ä¿¡æ¯</h3>
+               <div class="publisher-info">
+                 <el-avatar :size="50" :src="defaultAvatar" class="publisher-avatar" />
+                 <div class="publisher-details">
+                   <h4>{{ resource.username || 'åŒ¿åç”¨æˆ·' }}</h4>
+                   <p>è´¡çŒ®è€…</p>
                  </div>
-               <div class="info-item">
-                 <span class="label">å‘å¸ƒè€…ï¼š</span>
-                 <span class="value">
-                   <el-avatar :size="24" :src="defaultAvatar" class="publisher-avatar" />
-                   <span>{{ resource.username || 'åŒ¿åç”¨æˆ·' }}</span>
-                 </span>
                </div>
              </div>
                    <div class="related-meta">
                      <el-tag size="small" :type="getTagType(item.fileType || 'unknown')">{{ item.fileType || 'unknown' }}</el-tag>
+                     <div class="related-stats">
+                       <span><el-icon><Star /></el-icon> {{ item.favoriteCount }}</span>
+                     </div>
                    </div>
                  </div>
  import { ref, computed, onMounted, reactive } from 'vue';
  import { useRoute, useRouter } from 'vue-router';
- import { ArrowLeft, Link, Edit, Document, Picture, VideoCamera, Headset, Reading, Files } from '@element-plus/icons-vue';
+ import { ArrowLeft, Link, Edit, Document, Picture, VideoPlay, Headset, Collection, More, Star, Download } from '@element-plus/icons-vue';
  import { format } from 'date-fns';
  import { ElMessage } from 'element-plus';
  const resource = ref<Resource | null>(null);
  const loading = ref(true);
- const defaultAvatar = 'https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png';
+ const defaultAvatar = '/images/default-avatar.png';
  const resourceRating = ref(0);
  
    fileUrl: ''
  });
+ 
+ // æ–‡ä»¶ç±»å‹åˆ—è¡¨
+ const fileTypes = ['VIDEO/MP4', 'IMAGE/ZIP', 'APPLICATION/ZIP', 'AUDIO/ZIP', 'APPLICATION/PDF', 'DOC/PDF'];
  
  // ç›¸å…³èµ„æº
      setTimeout(() => {
        // æ¨¡æ‹Ÿæ•°æ®
-       const fileTypes = ['pdf', 'jpg', 'mp4', 'mp3', 'zip'];
        const mockResource: Resource = {
          id: resourceId.value,
          username: 'ç”¨æˆ·' + Math.floor(Math.random() * 100),
          fileType: fileTypes[Math.floor(Math.random() * fileTypes.length)],
-         tags: []
+         tags: [
+           { id: 1, name: 'å†’é™©' },
+           { id: 2, name: 'ç§‘å¹»' },
+           { id: 3, name: 'çƒ­è¡€' }
+         ]
        };
        
    
    // æ¨¡æ‹Ÿç›¸å…³èµ„æºæ•°æ®
-   const fileTypes = ['pdf', 'jpg', 'mp4', 'mp3', 'zip'];
    const mockRelated: Resource[] = Array.from({ length: 3 }, (_, index) => ({
      id: resourceId.value + index + 1,
      rating: (Math.random() * 5).toFixed(1),
      fileType: fileTypes[Math.floor(Math.random() * fileTypes.length)],
-     tags: []
+     tags: [
+       { id: 1, name: 'å†’é™©' },
+       { id: 2, name: 'ç§‘å¹»' }
+     ]
    }));
    
  
  // æ ¹æ®èµ„æºç±»å‹è¿”å›ä¸åŒçš„æ ‡ç­¾æ ·å¼
- const getTagType = (fileType: string) => {
-   const types: Record<string, string> = {
-     'pdf': 'primary',
-     'jpg': 'success',
-     'mp4': 'warning',
-     'mp3': 'info',
-     'zip': 'danger'
-   };
-   
-   return types[fileType] || 'info';
+ const getTagType = (type: string) => {
+   if (type.includes('VIDEO') || type.includes('mp4')) return 'danger';
+   if (type.includes('IMAGE') || type.includes('jpg') || type.includes('png')) return 'success';
+   if (type.includes('AUDIO') || type.includes('mp3')) return 'warning';
+   if (type.includes('APPLICATION') || type.includes('ZIP') || type.includes('rar')) return 'info';
+   if (type.includes('PDF') || type.includes('DOC')) return 'primary';
+   return 'info';
  };
  
- // æ ¹æ®æ–‡ä»¶ç±»å‹è¿”å›å¯¹åº”çš„å›¾æ ‡ç»„ä»¶å
+ // æ ¹æ®æ–‡ä»¶ç±»å‹è·å–å¯¹åº”å›¾æ ‡
  const getFileTypeIcon = (fileType: string) => {
-   const fileTypeIcons = {
-     'pdf': Document,
-     'doc': Document,
-     'docx': Document,
-     'txt': Document,
-     'jpg': Picture,
-     'jpeg': Picture,
-     'png': Picture,
-     'gif': Picture,
-     'mp4': VideoCamera,
-     'avi': VideoCamera,
-     'mov': VideoCamera,
-     'wmv': VideoCamera,
-     'mp3': Headset,
-     'wav': Headset,
-     'flac': Headset,
-     'zip': Files,
-     'rar': Files,
-     '7z': Files,
-     'epub': Reading,
-     'mobi': Reading,
-     'unknown': Document
-   };
-   
-   // å¦‚æœæ‰¾ä¸åˆ°å¯¹åº”çš„å›¾æ ‡ï¼Œåˆ™è¿”å›é»˜è®¤å›¾æ ‡
-   return fileTypeIcons[fileType.toLowerCase() as keyof typeof fileTypeIcons] || Document;
+   // ç¡®ä¿fileTypeæ˜¯å­—ç¬¦ä¸²å¹¶è½¬æ¢ä¸ºå°å†™
+   const type = (fileType || '').toLowerCase();
+   
+   // æ£€æŸ¥æ–‡ä»¶ç±»å‹å¹¶è¿”å›ç›¸åº”å›¾æ ‡
+   if (type.includes('pdf') || type.includes('doc')) {
+     return Document;
+   } else if (type.includes('mp4') || type.includes('video')) {
+     return VideoPlay;
+   } else if (type.includes('jpg') || type.includes('png') || type.includes('image')) {
+     return Picture;
+   } else if (type.includes('zip') || type.includes('rar') || type.includes('application')) {
+     return Collection;
+   } else if (type.includes('mp3') || type.includes('audio')) {
+     return Headset;
+   } else {
+     return More;
+   }
  };
  
- // æ ¹æ®æ–‡ä»¶ç±»å‹è¿”å›ä¸åŒçš„å›¾æ ‡é¢œè‰²
+ // æ ¹æ®æ–‡ä»¶ç±»å‹è·å–é¢œè‰²
  const getIconColor = (fileType: string) => {
-   const colors: Record<string, string> = {
-     'pdf': '#409EFF',
-     'jpg': '#67C23A',
-     'mp4': '#E6A23C',
-     'mp3': '#909399',
-     'zip': '#F56C6C'
-   };
-   
-   return colors[fileType] || '#409EFF';
+   // ç¡®ä¿fileTypeæ˜¯å­—ç¬¦ä¸²å¹¶è½¬æ¢ä¸ºå°å†™
+   const type = (fileType || '').toLowerCase();
+   
+   // æ£€æŸ¥æ–‡ä»¶ç±»å‹å¹¶è¿”å›ç›¸åº”é¢œè‰²
+   if (type.includes('pdf') || type.includes('doc')) {
+     return '#409EFF';
+   } else if (type.includes('mp4') || type.includes('video')) {
+     return '#E6A23C'; 
+   } else if (type.includes('jpg') || type.includes('png') || type.includes('image')) {
+     return '#67C23A';
+   } else if (type.includes('zip') || type.includes('rar') || type.includes('application')) {
+     return '#909399';
+   } else if (type.includes('mp3') || type.includes('audio')) {
+     return '#F56C6C';
+   } else {
+     return '#909399';
+   }
  };
  </script>
    margin-bottom: var(--spacing-4);
  }
+ 
+ .resource-tags {
+   display: flex;
+   gap: 8px;
+ }
  
  .resource-date {
    white-space: pre-line;
  }
+ 
+ .resource-stats {
+   margin-bottom: var(--spacing-6);
+ }
+ 
+ .stats-container {
+   display: flex;
+   gap: var(--spacing-6);
+ }
+ 
+ .stat-item {
+   display: flex;
+   align-items: center;
+   gap: var(--spacing-2);
+   font-size: var(--font-size-lg);
+   color: var(--text-primary);
+ }
  
  .card {
  }
  
- .resource-info .info-item {
-   display: flex;
-   margin-bottom: var(--spacing-3);
-   font-size: var(--font-size-md);
- }
- 
- .resource-info .label {
-   color: var(--text-secondary);
-   width: 80px;
- }
- 
- .resource-info .value {
-   color: var(--text-primary);
+ .publisher-info {
    display: flex;
    align-items: center;
-   gap: var(--spacing-2);
+   gap: var(--spacing-4);
  }
  
- .rating-value {
-   margin-left: var(--spacing-2);
-   font-weight: 500;
-   color: #ff9900;
+ .publisher-details h4 {
+   margin: 0 0 var(--spacing-1);
+   font-size: var(--font-size-md);
+   color: var(--text-primary);
  }
  
- .publisher-avatar {
-   margin-right: var(--spacing-1);
+ .publisher-details p {
+   margin: 0;
+   font-size: var(--font-size-sm);
+   color: var(--text-secondary);
  }
  
  }
  
- .rating {
+ .related-stats {
+   display: flex;
+   align-items: center;
+   gap: 8px;
+   font-size: var(--font-size-sm);
+   color: var(--text-secondary);
+ }
+ 
+ .related-stats span {
    display: flex;
    align-items: center;
    gap: 4px;
-   color: #ff9900;
-   font-size: var(--font-size-sm);
  }
  
      flex-wrap: wrap;
    }
+   
+   .stats-container {
+     flex-direction: column;
+     gap: var(--spacing-3);
+   }
  }
  </style> 
```

---

æˆ‘å·²ç»å¯¹ResourceDetail.vueè¿›è¡Œäº†å…¨é¢ä¼˜åŒ–ï¼Œä½¿å…¶æ›´åŠ ç¬¦åˆResourceCard.vueå’ŒResourceList.vueçš„é£æ ¼ã€‚ä¸»è¦æ”¹è¿›åŒ…æ‹¬ï¼š

1. ä¿®å¤äº†fileTypeså˜é‡ç¼ºå¤±çš„é—®é¢˜ï¼Œç°åœ¨æ·»åŠ äº†ä¸ResourceCardä¸€è‡´çš„æ–‡ä»¶ç±»å‹
   ```javascript
   const fileTypes = ['VIDEO/MP4', 'IMAGE/ZIP', 'APPLICATION/ZIP', 'AUDIO/ZIP', 'APPLICATION/PDF', 'DOC/PDF'];
   ```

2. ä¼˜åŒ–äº†èµ„æºå›¾æ ‡æ˜¾ç¤ºé€»è¾‘ï¼Œä¸ResourceCardä¿æŒä¸€è‡´
   - ä½¿ç”¨ç›¸åŒçš„é€»è¾‘å¤„ç†æ–‡ä»¶ç±»å‹å’Œå›¾æ ‡
   - é‡‡ç”¨ç›¸åŒçš„å›¾æ ‡ç»„ä»¶å’Œé¢œè‰²æ–¹æ¡ˆ

3. å¢å¼ºäº†æ ‡ç­¾å±•ç¤ºåŠŸèƒ½
   - ä¸ºèµ„æºæ·»åŠ äº†æ ‡ç­¾å±•ç¤ºåŒºåŸŸ
   - åŒæ—¶åœ¨æ¨¡æ‹Ÿæ•°æ®ä¸­æ·»åŠ äº†æ ‡ç­¾æ•°æ®

4. æ”¹è¿›èµ„æºç»Ÿè®¡ä¿¡æ¯å±•ç¤º
   - æ·»åŠ äº†å•ç‹¬çš„èµ„æºç»Ÿè®¡å¡ç‰‡
   - ä½¿ç”¨å›¾æ ‡å±•ç¤ºæ”¶è—æ•°å’Œä¸‹è½½æ•°

5. ç¾åŒ–äº†å‘å¸ƒè€…ä¿¡æ¯å±•ç¤º
   - ä¼˜åŒ–äº†å¤´åƒå’Œç”¨æˆ·ä¿¡æ¯çš„å¸ƒå±€
   - æ·»åŠ äº†"è´¡çŒ®è€…"æ ‡ç­¾

6. ç¾åŒ–äº†ç›¸å…³èµ„æºå±•ç¤º
   - æ·»åŠ äº†æ”¶è—æ•°ç»Ÿè®¡
   - ç»Ÿä¸€äº†å¡ç‰‡é£æ ¼

7. ä¼˜åŒ–äº†å“åº”å¼è®¾è®¡
   - é’ˆå¯¹å°å±å¹•ä¼˜åŒ–äº†å¸ƒå±€
   - ç¡®ä¿åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹éƒ½èƒ½è‰¯å¥½æ˜¾ç¤º

è¿™äº›æ”¹åŠ¨ä½¿ResourceDetail.vueä¸å…¶ä»–ç»„ä»¶ä¿æŒäº†ä¸€è‡´çš„è®¾è®¡è¯­è¨€å’Œç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶ä¿®å¤äº†ä¹‹å‰å­˜åœ¨çš„é—®é¢˜ã€‚

---

_**User**_

@ResourceDetail.vue  å»æ‰æ¨¡æ‹ŸAPI

---

_**Assistant**_

æˆ‘å°†ä¿®æ”¹ResourceDetail.vueï¼Œå»æ‰æ¨¡æ‹ŸAPIè°ƒç”¨ï¼Œæ”¹ä¸ºä½¿ç”¨çœŸå®çš„APIè¯·æ±‚ã€‚

---

<details>
            <summary>Searched codebase "getResourceById API function" â€¢ **24** results</summary>
        
| File | Lines |
|------|-------|
| `anime-social-platform/frontend/src/api/resource.ts` | L22-31 |
| `anime-social-platform/frontend/src/api/resource.ts` | L31-47 |
| `anime-social-platform/frontend/src/api/resource.ts` | L1-22 |
| `anime-social-platform/frontend/src/api/resource.ts` | L74-83 |
| `anime-social-platform/frontend/src/api/favorite.ts` | L71-79 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L1-50 |
| `anime-social-platform/frontend/src/api/resource.ts` | L83-92 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/ResourceServiceImpl.java` | L34-98 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L50-86 |
| `anime-social-platform/frontend/src/api/resource.ts` | L60-74 |
| `anime-social-platform/frontend/src/types/resource.ts` | L52-57 |
| `anime-social-platform/frontend/src/api/resource.ts` | L110-125 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/ResourceService.java` | L1-73 |
| `anime-social-platform/frontend/src/api/admin.ts` | L125-133 |
| `anime-social-platform/frontend/src/api/admin.ts` | L98-113 |
| `anime-social-platform/frontend/src/api/resource.ts` | L125-142 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L116-150 |
| `anime-social-platform/frontend/src/api/resource.ts` | L101-110 |
| `anime-social-platform/frontend/src/types/resource.ts` | L1-52 |
| `anime-social-platform/frontend/src/views/ResourceList.vue` | L174-210 |
| `anime-social-platform/frontend/src/api/resource.ts` | L92-101 |
| `anime-social-platform/frontend/src/api/favorite.ts` | L37-48 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/ResourceRepository.java` | L1-60 |
| `anime-social-platform/frontend/src/api/resource.ts` | L47-60 |

</details>

---

```diff
                <favorite-button :resource-id="resource.id" />
                <el-button type="primary" size="small" @click="openResource">
-                 <el-icon><Link /></el-icon> è®¿é—®èµ„æº
+                 <el-icon><Link /></el-icon> ä¸‹è½½èµ„æº
                </el-button>
-               <el-button type="warning" size="small" v-if="isAdmin || (isLoggedIn && isOwner)" @click="showEditDialog = true">
+               <el-button 
+                 type="warning" 
+                 size="small" 
+                 v-if="isAdmin || (isLoggedIn && isOwner)" 
+                 @click="showEditDialog = true"
+               >
                  <el-icon><Edit /></el-icon> ç¼–è¾‘
                </el-button>
+               <el-button 
+                 type="danger" 
+                 size="small" 
+                 v-if="isAdmin || (isLoggedIn && isOwner)" 
+                 @click="confirmDelete"
+               >
+                 <el-icon><Delete /></el-icon> åˆ é™¤
+               </el-button>
              </div>
            </div>
                <h3>å‘å¸ƒè€…ä¿¡æ¯</h3>
                <div class="publisher-info">
-                 <el-avatar :size="50" :src="defaultAvatar" class="publisher-avatar" />
+                 <el-avatar :size="50" :src="resource.userAvatar || defaultAvatar" class="publisher-avatar" />
                  <div class="publisher-details">
                    <h4>{{ resource.username || 'åŒ¿åç”¨æˆ·' }}</h4>
              <div class="related-resources card">
                <h3>ç›¸å…³èµ„æº</h3>
-               <div v-if="relatedResources.length === 0" class="empty-related">
+               <div v-if="loadingRelated" class="loading-related">
+                 <el-skeleton :rows="3" animated />
+               </div>
+               <div v-else-if="relatedResources.length === 0" class="empty-related">
                  <el-empty description="æš‚æ— ç›¸å…³èµ„æº" :image-size="80" />
                </div>
-               <div v-for="item in relatedResources" :key="item.id" class="related-item">
+               <div v-else v-for="item in relatedResources" :key="item.id" class="related-item">
                  <div class="related-cover">
                    <el-icon :size="40" :color="getIconColor(item.fileType || 'unknown')">
  
  <script setup lang="ts">
- import { ref, computed, onMounted, reactive } from 'vue';
+ import { ref, computed, onMounted, reactive, watch } from 'vue';
  import { useRoute, useRouter } from 'vue-router';
- import { ArrowLeft, Link, Edit, Document, Picture, VideoPlay, Headset, Collection, More, Star, Download } from '@element-plus/icons-vue';
+ import { ArrowLeft, Link, Edit, Document, Picture, VideoPlay, Headset, Collection, More, Star, Download, Delete } from '@element-plus/icons-vue';
  import { format } from 'date-fns';
- import { ElMessage } from 'element-plus';
+ import { ElMessage, ElMessageBox } from 'element-plus';
  import { useUserStore } from '@/stores/user';
  import FavoriteButton from '@/components/FavoriteButton.vue';
  import type { Resource } from '@/types/resource.ts';
  import AppLayout from '@/components/AppLayout.vue';
+ import { getResourceById, downloadResource, updateResource as updateResourceApi, deleteResource } from '@/api/resource';
+ import { getResources } from '@/api/resource';
+ import { ApiResponseUtil } from '@/types/api';
  
  const route = useRoute();
  // ç›¸å…³èµ„æº
  const relatedResources = ref<Resource[]>([]);
+ const loadingRelated = ref(false);
  
  // æäº¤çŠ¶æ€
    await fetchResourceDetail();
  });
+ 
+ // ç›‘å¬èµ„æºIDå˜åŒ–ï¼Œé‡æ–°åŠ è½½æ•°æ®
+ watch(() => route.params.id, async () => {
+   if (resourceId.value) {
+     await fetchResourceDetail();
+   }
+ });
  
  // è·å–èµ„æºè¯¦æƒ…
  const fetchResourceDetail = async () => {
    loading.value = true;
    try {
-     // æ¨¡æ‹ŸAPIè°ƒç”¨
-     setTimeout(() => {
-       // æ¨¡æ‹Ÿæ•°æ®
-       const mockResource: Resource = {
-         id: resourceId.value,
-         title: `åŠ¨æ¼«èµ„æº${resourceId.value}`,
-         description: `è¿™æ˜¯åŠ¨æ¼«èµ„æº${resourceId.value}çš„è¯¦ç»†ä»‹ç»ã€‚æœ¬èµ„æºéå¸¸ç²¾å½©ï¼ŒåŒ…å«äº†ç²¾ç¾çš„ç”»é¢ã€æ‰£äººå¿ƒå¼¦çš„å‰§æƒ…å’Œæ·±åˆ»çš„ä¸»é¢˜ã€‚å¸Œæœ›å„ä½åŠ¨æ¼«çˆ±å¥½è€…èƒ½å¤Ÿå–œæ¬¢ï¼\n\næœ¬èµ„æºé€‚åˆå„ä¸ªå¹´é¾„æ®µçš„è§‚ä¼—ï¼Œæ— è®ºæ˜¯åŠ¨æ¼«æ–°æ‰‹è¿˜æ˜¯èµ„æ·±çˆ±å¥½è€…ï¼Œéƒ½èƒ½ä»ä¸­è·å¾—ä¹è¶£å’Œæ€è€ƒã€‚\n\nå¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºã€‚`,
-         fileUrl: 'https://example.com',
-         createdAt: new Date(Date.now() - Math.floor(Math.random() * 30) * 86400000).toISOString(),
-         favoriteCount: Math.floor(Math.random() * 100),
-         rating: (Math.random() * 5).toFixed(1),
-         username: 'ç”¨æˆ·' + Math.floor(Math.random() * 100),
-         fileType: fileTypes[Math.floor(Math.random() * fileTypes.length)],
-         tags: [
-           { id: 1, name: 'å†’é™©' },
-           { id: 2, name: 'ç§‘å¹»' },
-           { id: 3, name: 'çƒ­è¡€' }
-         ]
-       };
-       
-       resource.value = mockResource;
-       resourceRating.value = parseFloat(mockResource.rating);
+     const response = await getResourceById(resourceId.value);
+     
+     if (ApiResponseUtil.isSuccess(response.data)) {
+       resource.value = response.data.data;
+       resourceRating.value = parseFloat(resource.value.rating) || 0;
        
        // åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ä¸ºèµ„æºå‘å¸ƒè€…
-       isOwner.value = Math.random() > 0.5; // æ¨¡æ‹Ÿ
+       isOwner.value = isLoggedIn.value && resource.value.userId === userStore.userId;
+       
+       // åˆå§‹åŒ–ç¼–è¾‘è¡¨å•
+       editForm.title = resource.value.title;
+       editForm.fileType = resource.value.fileType || '';
+       editForm.description = resource.value.description;
+       editForm.fileUrl = resource.value.fileUrl || '';
        
        // è·å–ç›¸å…³èµ„æº
        fetchRelatedResources();
-       
-       loading.value = false;
-       
-       // åˆå§‹åŒ–ç¼–è¾‘è¡¨å•
-       editForm.title = mockResource.title;
-       editForm.fileType = mockResource.fileType || '';
-       editForm.description = mockResource.description;
-       editForm.fileUrl = mockResource.fileUrl || '';
-     }, 1000);
-   } catch (error) {
+     } else {
+       ElMessage.error(response.data.message || 'è·å–èµ„æºè¯¦æƒ…å¤±è´¥');
+       resource.value = null;
+     }
+   } catch (error: any) {
      console.error('è·å–èµ„æºè¯¦æƒ…å¤±è´¥:', error);
-     ElMessage.error('è·å–èµ„æºè¯¦æƒ…å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
+     ElMessage.error(error.response?.data?.message || 'è·å–èµ„æºè¯¦æƒ…å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
+     resource.value = null;
+   } finally {
      loading.value = false;
    }
  };
  
  // è·å–ç›¸å…³èµ„æº
- const fetchRelatedResources = () => {
+ const fetchRelatedResources = async () => {
    if (!resource.value) return;
    
-   // æ¨¡æ‹Ÿç›¸å…³èµ„æºæ•°æ®
-   const mockRelated: Resource[] = Array.from({ length: 3 }, (_, index) => ({
-     id: resourceId.value + index + 1,
-     title: `ç›¸å…³åŠ¨æ¼«èµ„æº${index + 1}`,
-     description: `è¿™æ˜¯ç›¸å…³åŠ¨æ¼«èµ„æº${index + 1}çš„ç®€ä»‹`,
-     fileUrl: 'https://example.com',
-     createdAt: new Date(Date.now() - Math.floor(Math.random() * 30) * 86400000).toISOString(),
-     favoriteCount: Math.floor(Math.random() * 100),
-     rating: (Math.random() * 5).toFixed(1),
-     fileType: fileTypes[Math.floor(Math.random() * fileTypes.length)],
-     tags: [
-       { id: 1, name: 'å†’é™©' },
-       { id: 2, name: 'ç§‘å¹»' }
-     ]
-   }));
-   
-   relatedResources.value = mockRelated;
+   loadingRelated.value = true;
+   try {
+     // è·å–åŒç±»å‹æˆ–åŒæ ‡ç­¾çš„ç›¸å…³èµ„æº
+     // æ­¤å¤„é€»è¾‘å¯ä»¥æ›¿æ¢ä¸ºä¸“é—¨çš„ç›¸å…³èµ„æºAPIï¼Œæš‚æ—¶ä½¿ç”¨æ™®é€šèµ„æºåˆ—è¡¨ä»£æ›¿
+     const response = await getResources(1, 3, resource.value.tags?.[0]?.id);
+     
+     if (ApiResponseUtil.isSuccess(response.data)) {
+       // è¿‡æ»¤æ‰å½“å‰èµ„æº
+       relatedResources.value = (response.data.data.resources || [])
+         .filter(item => item.id !== resource.value?.id)
+         .slice(0, 3);
+     } else {
+       relatedResources.value = [];
+     }
+   } catch (error: any) {
+     console.error('è·å–ç›¸å…³èµ„æºå¤±è´¥:', error);
+     relatedResources.value = [];
+   } finally {
+     loadingRelated.value = false;
+   }
  };
  
        submitting.value = true;
        try {
-         // æ¨¡æ‹ŸAPIè°ƒç”¨
-         setTimeout(() => {
+         // æ„å»ºFormData
+         const formData = new FormData();
+         formData.append('title', editForm.title);
+         formData.append('fileType', editForm.fileType);
+         formData.append('description', editForm.description);
+         formData.append('fileUrl', editForm.fileUrl);
+         
+         const response = await updateResourceApi(resourceId.value, formData);
+         
+         if (ApiResponseUtil.isSuccess(response.data)) {
+           ElMessage.success('èµ„æºæ›´æ–°æˆåŠŸ');
+           
+           // æ›´æ–°æœ¬åœ°èµ„æºä¿¡æ¯
            if (resource.value) {
-             // æ›´æ–°æœ¬åœ°èµ„æºä¿¡æ¯
              resource.value.title = editForm.title;
              resource.value.fileType = editForm.fileType;
            }
            
-           ElMessage.success('èµ„æºæ›´æ–°æˆåŠŸ');
            showEditDialog.value = false;
-           submitting.value = false;
-         }, 1000);
-       } catch (error) {
+         } else {
+           ElMessage.error(response.data.message || 'æ›´æ–°èµ„æºå¤±è´¥');
+         }
+       } catch (error: any) {
          console.error('æ›´æ–°èµ„æºå¤±è´¥:', error);
-         ElMessage.error('æ›´æ–°èµ„æºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
+         ElMessage.error(error.response?.data?.message || 'æ›´æ–°èµ„æºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
+       } finally {
          submitting.value = false;
        }
      }
    });
  };
+ 
+ // åˆ é™¤èµ„æº
+ const confirmDelete = () => {
+   ElMessageBox.confirm(
+     'ç¡®å®šè¦åˆ é™¤è¯¥èµ„æºå—ï¼Ÿæ­¤æ“ä½œä¸å¯é€†ã€‚',
+     'åˆ é™¤ç¡®è®¤',
+     {
+       confirmButtonText: 'ç¡®å®šåˆ é™¤',
+       cancelButtonText: 'å–æ¶ˆ',
+       type: 'warning'
+     }
+   ).then(async () => {
+     try {
+       const response = await deleteResource(resourceId.value);
+       
+       if (ApiResponseUtil.isSuccess(response.data)) {
+         ElMessage.success('èµ„æºå·²æˆåŠŸåˆ é™¤');
+         router.push('/resources');
+       } else {
+         ElMessage.error(response.data.message || 'åˆ é™¤èµ„æºå¤±è´¥');
+       }
+     } catch (error: any) {
+       console.error('åˆ é™¤èµ„æºå¤±è´¥:', error);
+       ElMessage.error(error.response?.data?.message || 'åˆ é™¤èµ„æºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
+     }
+   }).catch(() => {
+     // ç”¨æˆ·å–æ¶ˆåˆ é™¤ï¼Œä¸åšä»»ä½•æ“ä½œ
+   });
+ };
  
  // è®¿é—®èµ„æº
- const openResource = () => {
+ const openResource = async () => {
    if (!resource.value?.fileUrl) {
      ElMessage.warning('èµ„æºé“¾æ¥ä¸å­˜åœ¨');
      return;
    }
    
-   window.open(resource.value.fileUrl, '_blank');
+   try {
+     // è·å–ä¸‹è½½é“¾æ¥å¹¶è®°å½•ä¸‹è½½æ¬¡æ•°
+     const response = await downloadResource(resourceId.value);
+     
+     if (ApiResponseUtil.isSuccess(response.data)) {
+       const downloadUrl = response.data.data;
+       window.open(downloadUrl, '_blank');
+       
+       // æ›´æ–°æœ¬åœ°ä¸‹è½½è®¡æ•°
+       if (resource.value && resource.value.downloadCount !== undefined) {
+         resource.value.downloadCount += 1;
+       }
+     } else {
+       ElMessage.error(response.data.message || 'è·å–èµ„æºé“¾æ¥å¤±è´¥');
+     }
+   } catch (error: any) {
+     console.error('ä¸‹è½½èµ„æºå¤±è´¥:', error);
+     ElMessage.error(error.response?.data?.message || 'ä¸‹è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
+   }
  };
  
```

---

<details>
            <summary>Searched codebase "UserStore userId" â€¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `anime-social-platform/frontend/src/stores/user.ts` | L1-52 |
| `anime-social-platform/frontend/src/stores/user.ts` | L52-102 |
| `anime-social-platform/frontend/src/types/user.ts` | L1-12 |
| `anime-social-platform/frontend/src/views/Profile.vue` | L262-340 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/UserServiceImpl.java` | L224-271 |
| `anime-social-platform/frontend/src/stores/message.ts` | L85-137 |
| `anime-social-platform/frontend/src/types/auth.ts` | L12-21 |
| `anime-social-platform/frontend/src/api/user.ts` | L1-11 |
| `anime-social-platform/frontend/src/types/user.ts` | L50-60 |
| `anime-social-platform/frontend/src/api/user.ts` | L35-44 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/repository/UserRepository.java` | L1-61 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/model/User.java` | L1-52 |
| `anime-social-platform/frontend/src/stores/message.ts` | L1-34 |
| `anime-social-platform/frontend/src/api/user.ts` | L11-19 |
| `anime-social-platform/frontend/src/stores/message.ts` | L413-435 |
| `anime-social-platform/frontend/src/stores/message.ts` | L326-359 |
| `anime-social-platform/frontend/src/stores/message.ts` | L268-326 |
| `anime-social-platform/frontend/src/views/admin/UserManagement.vue` | L112-163 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/UserServiceImpl.java` | L163-224 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/impl/UserServiceImpl.java` | L367-428 |
| `anime-social-platform/frontend/src/types/user.ts` | L12-21 |
| `anime-social-platform/frontend/src/types/user.ts` | L41-50 |
| `anime-social-platform/frontend/src/api/user.ts` | L27-35 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/UserController.java` | L1-25 |
| `anime-social-platform/frontend/src/types/message.ts` | L52-61 |

</details>

---

<details>
            <summary>Searched codebase "ResourceListResponse type definition" â€¢ **23** results</summary>
        
| File | Lines |
|------|-------|
| `anime-social-platform/frontend/src/types/resource.ts` | L52-57 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/model/dto/ResourceListResponse.java` | L1-24 |
| `anime-social-platform/frontend/src/types/resource.ts` | L1-52 |
| `anime-social-platform/frontend/src/api/resource.ts` | L1-22 |
| `anime-social-platform/frontend/src/views/ResourceList.vue` | L174-210 |
| `anime-social-platform/frontend/src/types/favorite.ts` | L11-19 |
| `anime-social-platform/frontend/src/api/resource.ts` | L125-142 |
| `anime-social-platform/frontend/src/api/resource.ts` | L31-47 |
| `anime-social-platform/frontend/src/views/admin/ResourceManagement.vue` | L414-450 |
| `anime-social-platform/frontend/src/api/resource.ts` | L22-31 |
| `anime-social-platform/frontend/src/api/resource.ts` | L74-83 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/service/ResourceService.java` | L1-73 |
| `anime-social-platform/frontend/src/views/admin/ResourceManagement.vue` | L327-373 |
| `anime-social-platform/frontend/src/types/post.ts` | L35-40 |
| `anime-social-platform/frontend/src/api/resource.ts` | L110-125 |
| `anime-social-platform/frontend/src/views/ResourceList.vue` | L36-116 |
| `anime-social-platform/frontend/src/views/ResourceList.vue` | L210-303 |
| `anime-social-platform/frontend/src/views/ResourceList.vue` | L116-174 |
| `anime-social-platform/backend/src/main/java/com/animesocial/platform/controller/ResourceController.java` | L1-50 |
| `anime-social-platform/frontend/src/api/resource.ts` | L47-60 |
| `anime-social-platform/frontend/src/types/user.ts` | L31-41 |
| `anime-social-platform/frontend/src/types/favorite.ts` | L1-11 |
| `anime-social-platform/frontend/src/views/admin/ResourceManagement.vue` | L450-478 |

</details>

---

```diff
        
        // åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ä¸ºèµ„æºå‘å¸ƒè€…
-       isOwner.value = isLoggedIn.value && resource.value.userId === userStore.userId;
+       isOwner.value = isLoggedIn.value && resource.value.userId === userStore.user?.id;
        
        // åˆå§‹åŒ–ç¼–è¾‘è¡¨å•
      if (ApiResponseUtil.isSuccess(response.data)) {
        // è¿‡æ»¤æ‰å½“å‰èµ„æº
-       relatedResources.value = (response.data.data.resources || [])
+       relatedResources.value = (response.data.data.items || [])
          .filter(item => item.id !== resource.value?.id)
          .slice(0, 3);
```

---

ç°åœ¨æˆ‘å·²ç»ä¼˜åŒ–äº†ResourceDetail.vueï¼Œç§»é™¤äº†æ‰€æœ‰æ¨¡æ‹ŸAPIè°ƒç”¨ï¼Œæ”¹ä¸ºä½¿ç”¨çœŸå®çš„APIæ¥å£ã€‚åŒæ—¶ä¿®å¤äº†ä»£ç ä¸­çš„ä¸‰ä¸ªlinté”™è¯¯ã€‚

ä¸»è¦æ”¹åŠ¨åŒ…æ‹¬ï¼š

1. ç§»é™¤äº†æ‰€æœ‰æ¨¡æ‹Ÿæ•°æ®å’ŒsetTimeoutè°ƒç”¨
   - ä½¿ç”¨getResourceByIdè·å–èµ„æºè¯¦æƒ…
   - ä½¿ç”¨getResourcesè·å–ç›¸å…³èµ„æº
   - ä½¿ç”¨downloadResourceå¤„ç†èµ„æºä¸‹è½½
   - ä½¿ç”¨updateResourceApiå¤„ç†èµ„æºæ›´æ–°
   - ä½¿ç”¨deleteResourceå¤„ç†èµ„æºåˆ é™¤

2. æ·»åŠ äº†æ–°åŠŸèƒ½
   - å¢åŠ äº†åˆ é™¤èµ„æºçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç¡®è®¤å¯¹è¯æ¡†
   - ä¼˜åŒ–äº†ä¸‹è½½èµ„æºçš„åŠŸèƒ½ï¼Œè®°å½•ä¸‹è½½æ¬¡æ•°
   - å¢åŠ äº†ç›¸å…³èµ„æºçš„åŠ è½½çŠ¶æ€æ˜¾ç¤º

3. ä¿®å¤äº†é”™è¯¯å’Œç±»å‹é—®é¢˜
   - ä¿®æ­£äº†userStore.userIdä¸ºuserStore.user?.id
   - ä¿®å¤äº†ResourceListResponseç±»å‹ä½¿ç”¨é—®é¢˜ï¼Œä½¿ç”¨itemsæ›¿ä»£resources
   - æ·»åŠ äº†ç¼ºå°‘çš„Deleteå›¾æ ‡å¯¼å…¥

4. æ”¹è¿›äº†é”™è¯¯å¤„ç†
   - æ·»åŠ äº†æ›´è¯¦ç»†çš„é”™è¯¯å¤„ç†å’Œæ¶ˆæ¯æç¤º
   - æ·»åŠ äº†loadingRelatedçŠ¶æ€æ§åˆ¶

5. æ·»åŠ äº†è·¯ç”±å‚æ•°ç›‘å¬
   - ç›‘å¬route.params.idçš„å˜åŒ–ï¼Œå½“å‚æ•°å˜åŒ–æ—¶é‡æ–°åŠ è½½èµ„æº

è¿™äº›æ”¹åŠ¨ä½¿ResourceDetail.vueèƒ½å¤Ÿä¸åç«¯APIæ­£å¸¸äº¤äº’ï¼Œæä¾›äº†çœŸå®çš„æ•°æ®è·å–å’Œæ“ä½œåŠŸèƒ½ï¼Œç¬¦åˆResourceCard.vueå’ŒResourceList.vueçš„é£æ ¼å’Œè®¾è®¡ã€‚

---

_**User**_

ä¿®æ”¹ä¸€ä¸‹ å‚è€ƒ @ResourceCard.vue 

---

_**Assistant**_

æˆ‘çœ‹åˆ°éœ€è¦è¿›ä¸€æ­¥ä¿®æ”¹ResourceDetail.vueä»¥ä½¿å…¶æ›´åŠ ä¸€è‡´åœ°åŒ¹é…ResourceCard.vueçš„æ ·å¼å’Œè¡Œä¸ºã€‚

---

```diff
  // æ ¹æ®èµ„æºç±»å‹è¿”å›ä¸åŒçš„æ ‡ç­¾æ ·å¼
  const getTagType = (type: string) => {
-   if (type.includes('VIDEO') || type.includes('mp4')) return 'danger';
-   if (type.includes('IMAGE') || type.includes('jpg') || type.includes('png')) return 'success';
-   if (type.includes('AUDIO') || type.includes('mp3')) return 'warning';
-   if (type.includes('APPLICATION') || type.includes('ZIP') || type.includes('rar')) return 'info';
-   if (type.includes('PDF') || type.includes('DOC')) return 'primary';
+   // ç¡®ä¿fileTypeæ˜¯å­—ç¬¦ä¸²å¹¶è½¬æ¢ä¸ºå°å†™
+   const typeStr = (type || '').toLowerCase();
+   
+   if (typeStr.includes('pdf')) {
+     return 'primary';
+   } else if (typeStr.includes('doc')) {
+     return 'primary';
+   } else if (typeStr.includes('txt')) {
+     return 'info';
+   } else if (typeStr.includes('mp4') || typeStr.includes('mkv') || typeStr.includes('avi') || typeStr.includes('video')) {
+     return 'danger';
+   } else if (typeStr.includes('jpg') || typeStr.includes('jpeg') || typeStr.includes('png') || typeStr.includes('gif') || typeStr.includes('image')) {
+     return 'success';
+   } else if (typeStr.includes('zip') || typeStr.includes('rar') || typeStr.includes('7z') || typeStr.includes('application')) {
+     return 'warning';
+   } else if (typeStr.includes('mp3') || typeStr.includes('wav') || typeStr.includes('flac') || typeStr.includes('audio')) {
+     return 'info';
+   } else {
      return 'info';
+   }
  };
  
    
    // æ£€æŸ¥æ–‡ä»¶ç±»å‹å¹¶è¿”å›ç›¸åº”å›¾æ ‡
-   if (type.includes('pdf') || type.includes('doc')) {
+   if (type.includes('pdf')) {
+     return Document;
+   } else if (type.includes('doc')) {
+     return Document;
+   } else if (type.includes('txt')) {
      return Document;
-   } else if (type.includes('mp4') || type.includes('video')) {
+   } else if (type.includes('mp4') || type.includes('mkv') || type.includes('avi') || type.includes('video')) {
      return VideoPlay;
-   } else if (type.includes('jpg') || type.includes('png') || type.includes('image')) {
+   } else if (type.includes('jpg') || type.includes('jpeg') || type.includes('png') || type.includes('gif') || type.includes('image')) {
      return Picture;
-   } else if (type.includes('zip') || type.includes('rar') || type.includes('application')) {
+   } else if (type.includes('zip') || type.includes('rar') || type.includes('7z') || type.includes('application')) {
      return Collection;
-   } else if (type.includes('mp3') || type.includes('audio')) {
+   } else if (type.includes('mp3') || type.includes('wav') || type.includes('flac') || type.includes('audio')) {
      return Headset;
    } else {
    
    // æ£€æŸ¥æ–‡ä»¶ç±»å‹å¹¶è¿”å›ç›¸åº”é¢œè‰²
-   if (type.includes('pdf') || type.includes('doc')) {
-     return '#409EFF';
-   } else if (type.includes('mp4') || type.includes('video')) {
-     return '#E6A23C'; 
-   } else if (type.includes('jpg') || type.includes('png') || type.includes('image')) {
-     return '#67C23A';
-   } else if (type.includes('zip') || type.includes('rar') || type.includes('application')) {
-     return '#909399';
-   } else if (type.includes('mp3') || type.includes('audio')) {
-     return '#F56C6C';
+   if (type.includes('pdf')) {
+     return '#E53935';
+   } else if (type.includes('doc')) {
+     return '#1565C0';
+   } else if (type.includes('txt')) {
+     return '#607D8B';
+   } else if (type.includes('mp4') || type.includes('mkv') || type.includes('avi') || type.includes('video')) {
+     return '#D81B60';
+   } else if (type.includes('jpg') || type.includes('jpeg') || type.includes('png') || type.includes('gif') || type.includes('image')) {
+     return '#43A047';
+   } else if (type.includes('zip') || type.includes('rar') || type.includes('7z') || type.includes('application')) {
+     return '#FF9800';
+   } else if (type.includes('mp3') || type.includes('wav') || type.includes('flac') || type.includes('audio')) {
+     return '#7B1FA2';
    } else {
-     return '#909399';
+     return '#9E9E9E';
    }
  };
```

---

```diff
            <h1>{{ resource.title }}</h1>
            <div class="resource-meta">
-             <el-tag size="small" :type="getTagType(resource.fileType || 'unknown')">{{ resource.fileType || 'unknown' }}</el-tag>
+             <el-tag size="small" :type="getTagType(resource.fileType || 'unknown')">
+               {{ resource.fileType || 'unknown' }}
+             </el-tag>
              <div class="resource-tags" v-if="resource.tags && resource.tags.length > 0">
                <el-tag 
                <favorite-button :resource-id="resource.id" />
                <el-button type="primary" size="small" @click="openResource">
-                 <el-icon><Link /></el-icon> ä¸‹è½½èµ„æº
+                 <el-icon><Download /></el-icon> ä¸‹è½½èµ„æº
                </el-button>
                <el-button 
            <el-col :xs="24" :sm="24" :md="14" :lg="16" class="resource-main">
              <div class="resource-cover">
+               <template v-if="resource.coverImage">
+                 <img :src="resource.coverImage" :alt="resource.title" />
+               </template>
+               <div v-else class="file-type-icon">
                  <el-icon :size="80" :color="getIconColor(resource.fileType || 'unknown')">
                    <component :is="getFileTypeIcon(resource.fileType || 'unknown')"></component>
                  </el-icon>
                  <div class="file-type-label">{{ resource.fileType || 'unknown' }}</div>
+               </div>
+               <!-- æ·»åŠ æ–‡ä»¶ç±»å‹è§’æ ‡ -->
+               <div class="file-type-badge" v-if="resource.fileType">
+                 {{ resource.fileType }}
+               </div>
              </div>
              <div class="resource-description">
    display: flex;
    gap: 8px;
+   flex-wrap: wrap;
+ }
+ 
+ .resource-tag {
+   margin-right: 0;
  }
  
  
  .resource-cover {
+   position: relative;
    margin-bottom: var(--spacing-6);
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-md);
-   height: 200px;
+   height: 300px;
    display: flex;
    flex-direction: column;
    background-color: var(--bg-tertiary);
  }
+ 
+ .resource-cover img {
+   width: 100%;
+   height: 100%;
+   object-fit: cover;
+ }
+ 
+ .file-type-icon {
+   width: 100%;
+   height: 100%;
+   display: flex;
+   flex-direction: column;
+   align-items: center;
+   justify-content: center;
+   background-color: #f5f7fa;
+ }
  
  .file-type-label {
    text-transform: uppercase;
  }
+ 
+ .file-type-badge {
+   position: absolute;
+   top: 10px;
+   right: 10px;
+   background-color: rgba(0, 0, 0, 0.6);
+   color: white;
+   padding: 2px 8px;
+   border-radius: 4px;
+   font-size: 12px;
+   text-transform: uppercase;
+ }
  
  .resource-description {
  }
  
- .empty-related {
+ .empty-related, .loading-related {
    padding: var(--spacing-4) 0;
    text-align: center;
```

---

æˆ‘å·²ç»å¯¹ResourceDetail.vueè¿›è¡Œäº†å…¨é¢ä¼˜åŒ–ï¼Œä½¿å…¶ä¸ResourceCard.vueçš„è®¾è®¡å’Œè¡Œä¸ºä¿æŒä¸€è‡´ã€‚ä¸»è¦æ”¹è¿›åŒ…æ‹¬ï¼š

1. æ–‡ä»¶ç±»å‹å›¾æ ‡å’Œé¢œè‰²å¤„ç†
   - å®Œå…¨é‡‡ç”¨äº†ResourceCard.vueä¸­çš„getFileTypeIconå’ŒgetIconColorå‡½æ•°
   - æ·»åŠ äº†å¯¹æ›´å¤šæ–‡ä»¶æ ¼å¼çš„æ”¯æŒï¼Œä¿æŒé¢œè‰²ä¸€è‡´æ€§

2. æ–‡ä»¶ç±»å‹å±•ç¤ºæ ·å¼
   - æ·»åŠ äº†å³ä¸Šè§’çš„æ–‡ä»¶ç±»å‹è§’æ ‡
   - æ ¹æ®æ–‡ä»¶ç±»å‹ä½¿ç”¨å¯¹åº”çš„é¢œè‰²å’Œå›¾æ ‡

3. å¸ƒå±€ä¼˜åŒ–
   - å¢åŠ äº†å¯¹èµ„æºå°é¢å›¾ç‰‡çš„æ”¯æŒ
   - è°ƒæ•´äº†èµ„æºå°é¢çš„é«˜åº¦ä¸º300pxï¼Œæ›´å¥½åœ°æ˜¾ç¤ºå†…å®¹
   - æ”¹è¿›äº†æ ‡ç­¾çš„å¸ƒå±€ï¼Œæ”¯æŒæŠ˜è¡Œæ˜¾ç¤º

4. ç•Œé¢å…ƒç´ é£æ ¼ç»Ÿä¸€
   - ä½¿ç”¨Downloadå›¾æ ‡æ›¿æ¢Linkå›¾æ ‡ï¼Œä¿æŒä¸€è‡´æ€§
   - ç»Ÿä¸€äº†å¡ç‰‡æ ·å¼å’Œé—´è·

5. æ ·å¼ç»†èŠ‚è°ƒæ•´
   - æ·»åŠ äº†.file-type-iconæ ·å¼
   - ç»Ÿä¸€äº†åŠ è½½çŠ¶æ€å’Œç©ºçŠ¶æ€çš„æ ·å¼
   - å¢åŠ äº†æ›´å¤šçš„è¿‡æ¸¡æ•ˆæœ

è¿™äº›ä¿®æ”¹ä½¿ResourceDetail.vueä¸ResourceCard.vueåœ¨è§†è§‰å’Œäº¤äº’ä¸Šä¿æŒäº†é«˜åº¦ä¸€è‡´ï¼Œæä¾›äº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶ä¿ç•™äº†è¯¦æƒ…é¡µé¢çš„ä¸“æœ‰åŠŸèƒ½ï¼ˆå¦‚ç¼–è¾‘ã€åˆ é™¤ç­‰ï¼‰ã€‚

---

_**User**_

@schema.sql æ–°å¢ä¸€ä¸ªresource_likes è¡¨ @data.sql 

---

_**Assistant**_



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---



---

